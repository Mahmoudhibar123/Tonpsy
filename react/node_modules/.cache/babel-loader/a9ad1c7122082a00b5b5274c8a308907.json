{"ast":null,"code":"var _jsxFileName = \"/home/fizoumizou/Documents/pfe/react/src/components/user/MyBookings.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Header from \"../Header\";\nimport Footer from \"../Footer\";\nimport { API_ENDPOINT, IMAGE_ENDPOINT, AppString } from \"../../constant\";\nimport { myFirestore } from \"../../Config/MyFirebase\";\nimport Placeholder from '../../assets/img/profile-placeholder.png';\n\nclass MyBookings extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getAppointments = () => {\n      axios.get(`${API_ENDPOINT}/bookings`, {\n        withCredentials: true\n      }).then(response => {\n        if (response.status === 200) {\n          var data = response.data.bookings;\n          this.setState({\n            list: data\n          });\n        }\n      }).catch(error => console.log(error));\n    };\n\n    this.gotoPayment = id => {\n      this.props.history.push(\"/pay\", {\n        id: id\n      });\n    };\n\n    this.gotoChat = async booking => {\n      const {\n        user\n      } = this.props;\n      console.log(\"Child Page User\", user); // Process Patient\n      // const result = await myFirestore\n      //   .collection(AppString.NODE_USERS)\n      //   .where(AppString.ID, \"==\", user.id)\n      //   .get();\n      // console.log(\"Firebase Result: \", result);\n      // if (result.docs.length === 0) {\n      //   // Set new data since this is a new user\n      //   await myFirestore\n      //     .collection(\"users\")\n      //     .doc(user.id.toString())\n      //     .set({\n      //       id: user.id,\n      //       nickname: `${user.first_name} ${user.last_name}`,\n      //       aboutMe: \"PATIENT\",\n      //       photoUrl: IMAGE_ENDPOINT + user.image,\n      //       friends: [booking.doctor.id],\n      //     });\n      // } else {\n      //   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\n      //     await myFirestore\n      //       .collection(\"users\")\n      //       .doc(user.id.toString())\n      //       .set({\n      //         friends: [booking.doctor.id],\n      //         merge: true,\n      //       });\n      //   }\n      // }\n      // Process Therapist\n      // const resultTherapist = await myFirestore\n      //   .collection(AppString.NODE_USERS)\n      //   .where(AppString.ID, \"==\", booking.doctor.id)\n      //   .get();\n      // if (resultTherapist.docs.length === 0) {\n      //   // Set new data since this is a new user\n      //   await myFirestore\n      //     .collection(\"users\")\n      //     .doc(booking.doctor.id.toString())\n      //     .set({\n      //       id: booking.doctor.id,\n      //       nickname: booking.doctor.name,\n      //       aboutMe: \"THERAPIST\",\n      //       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\n      //       friends: [user.id],\n      //     });\n      // } else {\n      //   if (\n      //     resultTherapist.docs[0].data().friends.indexOf(user.id) < 0\n      //   ) {\n      //     await myFirestore\n      //       .collection(\"users\")\n      //       .doc(booking.doctor.id.toString())\n      //       .set({\n      //         friends: [user.id],\n      //         merge: true,\n      //       });\n      //   }\n      // }\n\n      this.props.history.push(\"/main\", {\n        id: user.id\n      });\n    };\n\n    this.state = {\n      list: []\n    };\n  }\n\n  componentDidMount() {\n    this.getAppointments();\n  }\n\n  render() {\n    const {\n      loggedInStatus,\n      user,\n      handleLogout\n    } = this.props;\n    const {\n      list\n    } = this.state;\n    console.log(\"Booking Pages Props: \", this.props);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      loggedInStatus: loggedInStatus,\n      user: user,\n      isInner: true,\n      handleLogout: handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"section\", {\n      id: \"therapists\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"therapists-content pt-5 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-center pt-5 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 21\n      }\n    }, \" My Bookings  \")), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }, list.map((value, index) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card card-height height-auto\",\n        key: `booking-${value.id}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"image_container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: value.doctor ? IMAGE_ENDPOINT + value.doctor.image : Placeholder,\n        alt: \"avatar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 31\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md text-md-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        className: \"title-h2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 31\n        }\n      }, \" \", value.doctor ? value.doctor.name : \"N/A\", \"(THERAPIST)\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 33\n        }\n      }, \"Booking Date:\"), \" \", value.book_date ? value.book_date.split(\"T\")[0] : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 33\n        }\n      }, \"Timeslot:\"), \" \", value.timeslot)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-5 description\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 33\n        }\n      }, \"Status:\"), \" \", /*#__PURE__*/React.createElement(\"span\", {\n        className: \"badge badge-primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 33\n        }\n      }, value.status))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-12 text-right mt-3 mt-md-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 31\n        }\n      }, value.status.toLowerCase() === \"accepted\" && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-primary btn-sm w-auto mr-2\",\n        onClick: () => this.gotoPayment(value.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 35\n        }\n      }, \"Pay Now\"), value.status.toLowerCase() === \"paid\" && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-primary btn-sm w-auto\",\n        onClick: () => this.gotoChat(value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 35\n        }\n      }, \"Chat\")))))));\n    }), list.length <= 0 && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 40\n      }\n    }, \"You dont have any bookings yet.\")))))), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default MyBookings;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/MyBookings.js"],"names":["React","Component","axios","Header","Footer","API_ENDPOINT","IMAGE_ENDPOINT","AppString","myFirestore","Placeholder","MyBookings","constructor","props","getAppointments","get","withCredentials","then","response","status","data","bookings","setState","list","catch","error","console","log","gotoPayment","id","history","push","gotoChat","booking","user","state","componentDidMount","render","loggedInStatus","handleLogout","map","value","index","doctor","image","name","book_date","split","timeslot","toLowerCase","length"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,YAAT,EAAuBC,cAAvB,EAAuCC,SAAvC,QAAwD,gBAAxD;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,OAAOC,WAAP,MAAwB,0CAAxB;;AAEA,MAAMC,UAAN,SAAyBT,SAAzB,CAAmC;AACjCU,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAWnBC,eAXmB,GAWD,MAAM;AACtBX,MAAAA,KAAK,CACFY,GADH,CACQ,GAAET,YAAa,WADvB,EACmC;AAAEU,QAAAA,eAAe,EAAE;AAAnB,OADnC,EAEGC,IAFH,CAESC,QAAD,IAAc;AAClB,YAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,cAAIC,IAAI,GAAGF,QAAQ,CAACE,IAAT,CAAcC,QAAzB;AACA,eAAKC,QAAL,CAAc;AAAEC,YAAAA,IAAI,EAAEH;AAAR,WAAd;AACD;AACF,OAPH,EAQGI,KARH,CAQUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CARpB;AASD,KArBkB;;AAAA,SAuBnBG,WAvBmB,GAuBJC,EAAD,IAAQ;AACpB,WAAKhB,KAAL,CAAWiB,OAAX,CAAmBC,IAAnB,CAAwB,MAAxB,EAAgC;AAAEF,QAAAA,EAAE,EAAEA;AAAN,OAAhC;AACD,KAzBkB;;AAAA,SA2BnBG,QA3BmB,GA2BR,MAAOC,OAAP,IAAmB;AAC5B,YAAM;AAAEC,QAAAA;AAAF,UAAW,KAAKrB,KAAtB;AAEAa,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BO,IAA/B,EAH4B,CAI5B;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAKrB,KAAL,CAAWiB,OAAX,CAAmBC,IAAnB,CAAwB,OAAxB,EAAiC;AAAEF,QAAAA,EAAE,EAAEK,IAAI,CAACL;AAAX,OAAjC;AACD,KA/FkB;;AAEjB,SAAKM,KAAL,GAAa;AACXZ,MAAAA,IAAI,EAAE;AADK,KAAb;AAGD;;AAEDa,EAAAA,iBAAiB,GAAG;AAClB,SAAKtB,eAAL;AACD;;AAwFDuB,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA,cAAF;AAAkBJ,MAAAA,IAAlB;AAAwBK,MAAAA;AAAxB,QAAyC,KAAK1B,KAApD;AACA,UAAM;AAAEU,MAAAA;AAAF,QAAW,KAAKY,KAAtB;AAEAT,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqC,KAAKd,KAA1C;AAEA,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AAAQ,MAAA,cAAc,EAAEyB,cAAxB;AAAwC,MAAA,IAAI,EAAEJ,IAA9C;AAAoD,MAAA,OAAO,EAAE,IAA7D;AAAmE,MAAA,YAAY,EAAEK,YAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE;AAAS,MAAA,EAAE,EAAC,YAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CADF,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CADF,eAQE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGhB,IAAI,CAACiB,GAAL,CAAS,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAC1B,0BACE;AACE,QAAA,SAAS,EAAC,8BADZ;AAEE,QAAA,GAAG,EAAG,WAAUD,KAAK,CAACZ,EAAG,EAF3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAGE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AACE,QAAA,GAAG,EACDY,KAAK,CAACE,MAAN,GACIpC,cAAc,GAAGkC,KAAK,CAACE,MAAN,CAAaC,KADlC,GAC0ClC,WAH9C;AAKE,QAAA,GAAG,EAAC,QALN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,CADF,eAYE;AAAK,QAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAI,QAAA,SAAS,EAAC,UAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,GADH,EAEG+B,KAAK,CAACE,MAAN,GAAeF,KAAK,CAACE,MAAN,CAAaE,IAA5B,GAAmC,KAFtC,gBADF,CADF,eAQE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADF,EACiC,GADjC,EAEGJ,KAAK,CAACK,SAAN,GACGL,KAAK,CAACK,SAAN,CAAgBC,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CADH,GAEG,EAJN,CADF,eAOE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,OAC8BN,KAAK,CAACO,QADpC,CAPF,CARF,eAmBE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAC2B,GAD3B,eAEE;AAAM,QAAA,SAAS,EAAC,qBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGP,KAAK,CAACtB,MADT,CAFF,CADF,CAnBF,eA2BE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,mCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGsB,KAAK,CAACtB,MAAN,CAAa8B,WAAb,OAA+B,UAA/B,iBACC;AACE,QAAA,SAAS,EAAC,oCADZ;AAEE,QAAA,OAAO,EAAE,MAAM,KAAKrB,WAAL,CAAiBa,KAAK,CAACZ,EAAvB,CAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAFJ,EASGY,KAAK,CAACtB,MAAN,CAAa8B,WAAb,OAA+B,MAA/B,iBACC,uDACA;AACE,QAAA,SAAS,EAAC,+BADZ;AAEE,QAAA,OAAO,EAAE,MAAM,KAAKjB,QAAL,CAAcS,KAAd,CAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,CAVJ,CADF,CA3BF,CAZF,CAHF,CADF;AAqED,KAtEA,CADH,EAwEGlB,IAAI,CAAC2B,MAAL,IAAe,CAAf,iBAAoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAxEvB,CARF,CADF,CADF,CADF,CAFF,eA2FE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA3FF,CADF;AA+FD;;AAvMgC;;AA0MnC,eAAevC,UAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport { API_ENDPOINT, IMAGE_ENDPOINT, AppString } from \"../../constant\";\r\nimport { myFirestore } from \"../../Config/MyFirebase\";\r\nimport Placeholder from '../../assets/img/profile-placeholder.png';\r\n\r\nclass MyBookings extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      list: [],\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getAppointments();\r\n  }\r\n\r\n  getAppointments = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/bookings`, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          var data = response.data.bookings;\r\n          this.setState({ list: data });\r\n        }\r\n      })\r\n      .catch((error) => console.log(error));\r\n  };\r\n\r\n  gotoPayment = (id) => {\r\n    this.props.history.push(\"/pay\", { id: id });\r\n  };\r\n\r\n  gotoChat = async (booking) => {\r\n    const { user } = this.props;\r\n\r\n    console.log(\"Child Page User\", user)\r\n    // Process Patient\r\n    // const result = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", user.id)\r\n    //   .get();\r\n\r\n    // console.log(\"Firebase Result: \", result);\r\n\r\n    // if (result.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(user.id.toString())\r\n    //     .set({\r\n    //       id: user.id,\r\n    //       nickname: `${user.first_name} ${user.last_name}`,\r\n    //       aboutMe: \"PATIENT\",\r\n    //       photoUrl: IMAGE_ENDPOINT + user.image,\r\n    //       friends: [booking.doctor.id],\r\n    //     });\r\n    // } else {\r\n    //   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(user.id.toString())\r\n    //       .set({\r\n    //         friends: [booking.doctor.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n\r\n    // Process Therapist\r\n    // const resultTherapist = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", booking.doctor.id)\r\n    //   .get();\r\n\r\n    // if (resultTherapist.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(booking.doctor.id.toString())\r\n    //     .set({\r\n    //       id: booking.doctor.id,\r\n    //       nickname: booking.doctor.name,\r\n    //       aboutMe: \"THERAPIST\",\r\n    //       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\r\n    //       friends: [user.id],\r\n    //     });\r\n    // } else {\r\n    //   if (\r\n    //     resultTherapist.docs[0].data().friends.indexOf(user.id) < 0\r\n    //   ) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(booking.doctor.id.toString())\r\n    //       .set({\r\n    //         friends: [user.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n    this.props.history.push(\"/main\", { id: user.id });\r\n  };\r\n\r\n  render() {\r\n    const { loggedInStatus, user, handleLogout } = this.props;\r\n    const { list } = this.state;\r\n\r\n    console.log(\"Booking Pages Props: \", this.props)\r\n\r\n    return (\r\n      <div>\r\n        <Header loggedInStatus={loggedInStatus} user={user} isInner={true} handleLogout={handleLogout} />\r\n        <section id=\"therapists\">\r\n          <div className=\"container\">\r\n            <div className=\"therapists-content pt-5 pb-2\">\r\n              <div className=\"row\">\r\n                <div className=\"col-md-12\">\r\n                  <div className=\"text-center pt-5 pb-2\">\r\n                    <h2> My Bookings  </h2>\r\n                  </div>\r\n                  <hr />\r\n                </div>\r\n\r\n                <div className=\"col-md-12\">\r\n                  {list.map((value, index) => {\r\n                    return (\r\n                      <div\r\n                        className=\"card card-height height-auto\"\r\n                        key={`booking-${value.id}`}  >\r\n                        <div className=\"row\">\r\n                          <div className=\"col-md-auto\">\r\n                            <div className=\"image_container\">\r\n                              <img\r\n                                src={\r\n                                  value.doctor\r\n                                    ? IMAGE_ENDPOINT + value.doctor.image : Placeholder\r\n                                }\r\n                                alt=\"avatar\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"col-md text-md-left\">\r\n                            <div className=\"title\">\r\n                              <h2 className=\"title-h2\">\r\n                                {\" \"}\r\n                                {value.doctor ? value.doctor.name : \"N/A\"}\r\n                                (THERAPIST)\r\n                              </h2>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5\">\r\n                                <strong>Booking Date:</strong>{\" \"}\r\n                                {value.book_date\r\n                                  ? value.book_date.split(\"T\")[0]\r\n                                  : \"\"}\r\n                              </div>\r\n                              <div className=\"col-md-7\">\r\n                                <strong>Timeslot:</strong> {value.timeslot}\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5 description\">\r\n                                <strong>Status:</strong>{\" \"}\r\n                                <span className=\"badge badge-primary\">\r\n                                  {value.status}\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-12 text-right mt-3 mt-md-0\">\r\n                                {value.status.toLowerCase() === \"accepted\" && (\r\n                                  <button\r\n                                    className=\"btn btn-primary btn-sm w-auto mr-2\"\r\n                                    onClick={() => this.gotoPayment(value.id)}\r\n                                  >\r\n                                    Pay Now\r\n                                  </button>\r\n                                )}\r\n                                {value.status.toLowerCase() === \"paid\" && (\r\n                                  <>\r\n                                  <button\r\n                                    className=\"btn btn-primary btn-sm w-auto\"\r\n                                    onClick={() => this.gotoChat(value)}\r\n                                  >\r\n                                    Chat\r\n                                  </button>\r\n                                  </>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                  {list.length <= 0 && <p>You dont have any bookings yet.</p>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MyBookings;\r\n"]},"metadata":{},"sourceType":"module"}