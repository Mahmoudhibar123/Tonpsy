{"ast":null,"code":"var _jsxFileName = \"/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistBookings.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Header from \"../Header\";\nimport Footer from \"../Footer\";\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\nimport { API_ENDPOINT, IMAGE_ENDPOINT, AppString } from \"../../constant\";\nimport { myFirestore } from \"../../Config/MyFirebase\";\n\nclass TherapistBookings extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getAppointments = () => {\n      axios.get(`${API_ENDPOINT}/doctors/bookings`, {\n        withCredentials: true\n      }).then(response => {\n        if (response.status === 200) {\n          var data = response.data.bookings;\n          this.setState({\n            list: data\n          });\n        }\n      }).catch(error => console.log(error));\n    };\n\n    this.onBookingUpdate = (id, status) => {\n      axios.put(`${API_ENDPOINT}/bookings/${id}/update_status?status=${status}`, {}, {\n        withCredentials: true\n      }).then(response => {\n        if (response.status === 200 || response.status === 204) {\n          this.props.showToast(1, 'Booking updated.');\n          this.getAppointments();\n        }\n      }).catch(error => console.log(error));\n    };\n\n    this.gotoChat = async booking => {\n      // this.props.history.push(\"/main\", { id: booking.doctor.id, rmUser: booking.user });\n      // const result = await myFirestore\n      //   .collection(AppString.NODE_USERS)\n      //   .where(AppString.ID, \"==\", booking.user.id)\n      //   .get();\n      // if (result.docs.length === 0) {\n      //   // Set new data since this is a new user\n      //   await myFirestore\n      //     .collection(\"users\")\n      //     .doc(booking.user.id.toString())\n      //     .set({\n      //       id: booking.user.id,\n      //       nickname: `${booking.user.first_name} ${booking.user.last_name}`,\n      //       aboutMe: \"PATIENT\",\n      //       photoUrl: IMAGE_ENDPOINT + booking.user.image,\n      //       friends: [booking.doctor.id],\n      //     });\n      // } else {\n      //   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\n      //     await myFirestore\n      //       .collection(\"users\")\n      //       .doc(booking.user.id.toString())\n      //       .set({\n      //         friends: [booking.doctor.id],\n      //         merge: true,\n      //       });\n      //   }\n      // }\n      // // Process Therapist\n      // const resultTherapist = await myFirestore\n      //   .collection(AppString.NODE_USERS)\n      //   .where(AppString.ID, \"==\", booking.doctor.id)\n      //   .get();\n      // if (resultTherapist.docs.length === 0) {\n      //   // Set new data since this is a new user\n      //   await myFirestore\n      //     .collection(\"users\")\n      //     .doc(booking.doctor.id.toString())\n      //     .set({\n      //       id: booking.doctor.id,\n      //       nickname: booking.doctor.name,\n      //       aboutMe: \"THERAPIST\",\n      //       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\n      //       friends: [booking.user.id],\n      //     });\n      // } else {\n      //   if (resultTherapist.docs[0].data().friends.indexOf(booking.user.id) < 0) {\n      //     await myFirestore\n      //       .collection(\"users\")\n      //       .doc(booking.doctor.id.toString())\n      //       .set({\n      //         friends: [booking.user.id],\n      //         merge: true,\n      //       });\n      //   }\n      // }\n      this.props.history.push(\"/main\", {\n        id: booking.doctor.id\n      });\n    };\n\n    this.gotoCall = booking => {\n      console.log(booking);\n    };\n\n    this.state = {\n      list: []\n    };\n  }\n\n  componentDidMount() {\n    this.getAppointments();\n  }\n\n  render() {\n    const {\n      loggedInStatus,\n      user,\n      handleLogout\n    } = this.props;\n    const {\n      list\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      loggedInStatus: loggedInStatus,\n      isInner: true,\n      user: user,\n      handleLogout: handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"section\", {\n      id: \"therapists\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"therapists-content pt-5 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-center pt-5 pb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }, \"Patient Bookings \")), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }\n    }, list.map((value, index) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card card-height height-auto\",\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"image_container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: value.user && value.user.image ? IMAGE_ENDPOINT + value.user.image : placeholder,\n        alt: \"Generic placeholder\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 31\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md text-md-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        className: \"title-h2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 31\n        }\n      }, value.user ? `${value.user.first_name || 'UNKNOWN'} ${value.user.last_name || 'UNKNOWN'}` : \"N/A\", \" \", \"(PATIENT)\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 33\n        }\n      }, \"Booking Date:\"), \" \", value.book_date ? value.book_date.split(\"T\")[0] : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 33\n        }\n      }, \"Timeslot:\"), \" \", value.timeslot)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-5 description\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 33\n        }\n      }, \"Status:\"), \" \", /*#__PURE__*/React.createElement(\"span\", {\n        className: \"badge badge-primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 33\n        }\n      }, value.status)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-7 text-right mt-3 mt-md-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 31\n        }\n      }, value.status.toLowerCase() !== \"paid\" && value.status.toLowerCase() !== \"accepted\" && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-danger btn-sm w-auto mr-2\",\n        onClick: () => this.onBookingUpdate(value.id, 2),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 37\n        }\n      }, \"Reject\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-success btn-sm w-auto\",\n        onClick: () => this.onBookingUpdate(value.id, 1),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 37\n        }\n      }, \"Accept\")), value.status.toLowerCase() === \"paid\" && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-primary btn-sm w-auto ml-2\",\n        onClick: () => this.gotoChat(value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 35\n        }\n      }, \"Chat\")))))));\n    }), list.length <= 0 && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 40\n      }\n    }, \"You dont have any bookings yet.\")))))), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default TherapistBookings;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistBookings.js"],"names":["React","Component","axios","Header","Footer","placeholder","API_ENDPOINT","IMAGE_ENDPOINT","AppString","myFirestore","TherapistBookings","constructor","props","getAppointments","get","withCredentials","then","response","status","data","bookings","setState","list","catch","error","console","log","onBookingUpdate","id","put","showToast","gotoChat","booking","history","push","doctor","gotoCall","state","componentDidMount","render","loggedInStatus","user","handleLogout","map","value","index","image","first_name","last_name","book_date","split","timeslot","toLowerCase","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\r\nimport { API_ENDPOINT, IMAGE_ENDPOINT, AppString } from \"../../constant\";\r\nimport { myFirestore } from \"../../Config/MyFirebase\";\r\n\r\n\r\nclass TherapistBookings extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      list: [],\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getAppointments();\r\n  }\r\n\r\n  getAppointments = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/doctors/bookings`, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          var data = response.data.bookings;\r\n          this.setState({ list: data });\r\n        }\r\n      })\r\n      .catch((error) => console.log(error));\r\n  };\r\n\r\n  onBookingUpdate = (id, status) => {\r\n    axios\r\n      .put(\r\n        `${API_ENDPOINT}/bookings/${id}/update_status?status=${status}`,\r\n        {},\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        if (response.status === 200 || response.status === 204) {\r\n          this.props.showToast(1, 'Booking updated.')\r\n          this.getAppointments();\r\n        }\r\n      })\r\n      .catch((error) => console.log(error));\r\n  };\r\n\r\n  gotoChat = async (booking) => {\r\n    // this.props.history.push(\"/main\", { id: booking.doctor.id, rmUser: booking.user });\r\n\r\n    // const result = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", booking.user.id)\r\n    //   .get();\r\n\r\n    // if (result.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(booking.user.id.toString())\r\n    //     .set({\r\n    //       id: booking.user.id,\r\n    //       nickname: `${booking.user.first_name} ${booking.user.last_name}`,\r\n    //       aboutMe: \"PATIENT\",\r\n    //       photoUrl: IMAGE_ENDPOINT + booking.user.image,\r\n    //       friends: [booking.doctor.id],\r\n    //     });\r\n    // } else {\r\n    //   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(booking.user.id.toString())\r\n    //       .set({\r\n    //         friends: [booking.doctor.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n\r\n    // // Process Therapist\r\n    // const resultTherapist = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", booking.doctor.id)\r\n    //   .get();\r\n\r\n    // if (resultTherapist.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(booking.doctor.id.toString())\r\n    //     .set({\r\n    //       id: booking.doctor.id,\r\n    //       nickname: booking.doctor.name,\r\n    //       aboutMe: \"THERAPIST\",\r\n    //       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\r\n    //       friends: [booking.user.id],\r\n    //     });\r\n    // } else {\r\n    //   if (resultTherapist.docs[0].data().friends.indexOf(booking.user.id) < 0) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(booking.doctor.id.toString())\r\n    //       .set({\r\n    //         friends: [booking.user.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n    this.props.history.push(\"/main\", { id: booking.doctor.id });\r\n  };\r\n\r\n  gotoCall = (booking) => {\r\n    console.log(booking)\r\n  }\r\n\r\n  render() {\r\n    const { loggedInStatus, user, handleLogout } = this.props;\r\n    const { list } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <Header loggedInStatus={loggedInStatus} isInner={true} user={user} handleLogout={handleLogout} />\r\n        <section id=\"therapists\">\r\n          <div className=\"container\">\r\n            <div className=\"therapists-content pt-5 pb-2\">\r\n              <div className=\"row\">\r\n                <div className=\"col-md-12\">\r\n                  <div className=\"text-center pt-5 pb-2\">\r\n                    <h2>Patient Bookings </h2>\r\n                  </div>\r\n                  <hr />\r\n                </div>\r\n\r\n                <div className=\"col-md-12\">\r\n                  {list.map((value, index) => {\r\n                    return (\r\n                      <div className=\"card card-height height-auto\" key={index}>\r\n                        <div className=\"row\">\r\n                          <div className=\"col-md-auto\">\r\n                            <div className=\"image_container\">\r\n                              <img\r\n                                src={\r\n                                  value.user && value.user.image\r\n                                    ? IMAGE_ENDPOINT + value.user.image\r\n                                    : placeholder\r\n                                }\r\n                                alt=\"Generic placeholder\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"col-md text-md-left\">\r\n                            <div className=\"title\">\r\n                              <h2 className=\"title-h2\">\r\n                                {value.user\r\n                                  ? `${value.user.first_name || 'UNKNOWN'} ${value.user.last_name || 'UNKNOWN'}`\r\n                                  : \"N/A\"}{\" \"}\r\n                                (PATIENT)\r\n                              </h2>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5\">\r\n                                <strong>Booking Date:</strong>{\" \"}\r\n                                {value.book_date\r\n                                  ? value.book_date.split(\"T\")[0]\r\n                                  : \"\"}\r\n                              </div>\r\n                              <div className=\"col-md-7\">\r\n                                <strong>Timeslot:</strong> {value.timeslot}\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5 description\">\r\n                                <strong>Status:</strong>{\" \"}\r\n                                <span className=\"badge badge-primary\">\r\n                                  {value.status}\r\n                                </span>\r\n                              </div>\r\n                              <div className=\"col-md-7 text-right mt-3 mt-md-0\">\r\n                                {value.status.toLowerCase() !== \"paid\" && value.status.toLowerCase() !== \"accepted\" && (\r\n                                  <>\r\n                                    <button\r\n                                      className=\"btn btn-danger btn-sm w-auto mr-2\"\r\n                                      onClick={() =>\r\n                                        this.onBookingUpdate(value.id, 2)\r\n                                      }\r\n                                    >\r\n                                      Reject\r\n                                    </button>\r\n                                    <button\r\n                                      className=\"btn btn-success btn-sm w-auto\"\r\n                                      onClick={() =>\r\n                                        this.onBookingUpdate(value.id, 1)\r\n                                      }\r\n                                    >\r\n                                      Accept\r\n                                    </button>\r\n                                  </>\r\n                                )}\r\n                                {value.status.toLowerCase() === \"paid\" && (\r\n                                  <>\r\n                                  <button\r\n                                    className=\"btn btn-primary btn-sm w-auto ml-2\"\r\n                                    onClick={() => this.gotoChat(value)}\r\n                                  >\r\n                                    Chat\r\n                                  </button>\r\n                                  </>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                  {list.length <= 0 && <p>You dont have any bookings yet.</p>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TherapistBookings;\r\n"]},"metadata":{},"sourceType":"module"}