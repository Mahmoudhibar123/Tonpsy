{"ast":null,"code":"import _regeneratorRuntime from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import Header from\"../Header\";import Footer from\"../Footer\";import{API_ENDPOINT,IMAGE_ENDPOINT,AppString}from\"../../constant\";import{myFirestore}from\"../../Config/MyFirebase\";import Placeholder from'../../assets/img/profile-placeholder.png';var MyBookings=/*#__PURE__*/function(_Component){_inherits(MyBookings,_Component);var _super=_createSuper(MyBookings);function MyBookings(props){var _this;_classCallCheck(this,MyBookings);_this=_super.call(this,props);_this.getAppointments=function(){axios.get(\"\".concat(API_ENDPOINT,\"/bookings\"),{withCredentials:true}).then(function(response){if(response.status===200){var data=response.data.bookings;_this.setState({list:data});}}).catch(function(error){return console.log(error);});};_this.gotoPayment=function(id){_this.props.history.push(\"/pay\",{id:id});};_this.gotoChat=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(booking){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:user=_this.props.user;console.log(\"Child Page User\",user);// Process Patient\n// const result = await myFirestore\n//   .collection(AppString.NODE_USERS)\n//   .where(AppString.ID, \"==\", user.id)\n//   .get();\n// console.log(\"Firebase Result: \", result);\n// if (result.docs.length === 0) {\n//   // Set new data since this is a new user\n//   await myFirestore\n//     .collection(\"users\")\n//     .doc(user.id.toString())\n//     .set({\n//       id: user.id,\n//       nickname: `${user.first_name} ${user.last_name}`,\n//       aboutMe: \"PATIENT\",\n//       photoUrl: IMAGE_ENDPOINT + user.image,\n//       friends: [booking.doctor.id],\n//     });\n// } else {\n//   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\n//     await myFirestore\n//       .collection(\"users\")\n//       .doc(user.id.toString())\n//       .set({\n//         friends: [booking.doctor.id],\n//         merge: true,\n//       });\n//   }\n// }\n// Process Therapist\n// const resultTherapist = await myFirestore\n//   .collection(AppString.NODE_USERS)\n//   .where(AppString.ID, \"==\", booking.doctor.id)\n//   .get();\n// if (resultTherapist.docs.length === 0) {\n//   // Set new data since this is a new user\n//   await myFirestore\n//     .collection(\"users\")\n//     .doc(booking.doctor.id.toString())\n//     .set({\n//       id: booking.doctor.id,\n//       nickname: booking.doctor.name,\n//       aboutMe: \"THERAPIST\",\n//       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\n//       friends: [user.id],\n//     });\n// } else {\n//   if (\n//     resultTherapist.docs[0].data().friends.indexOf(user.id) < 0\n//   ) {\n//     await myFirestore\n//       .collection(\"users\")\n//       .doc(booking.doctor.id.toString())\n//       .set({\n//         friends: [user.id],\n//         merge: true,\n//       });\n//   }\n// }\n_this.props.history.push(\"/main\",{id:user.id});case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={list:[]};return _this;}_createClass(MyBookings,[{key:\"componentDidMount\",value:function componentDidMount(){this.getAppointments();}},{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,loggedInStatus=_this$props.loggedInStatus,user=_this$props.user,handleLogout=_this$props.handleLogout;var list=this.state.list;console.log(\"Booking Pages Props: \",this.props);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,{loggedInStatus:loggedInStatus,user:user,isInner:true,handleLogout:handleLogout}),/*#__PURE__*/React.createElement(\"section\",{id:\"therapists\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"therapists-content pt-5 pb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-center pt-5 pb-2\"},/*#__PURE__*/React.createElement(\"h2\",null,\" My Bookings  \")),/*#__PURE__*/React.createElement(\"hr\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12\"},list.map(function(value,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"card card-height height-auto\",key:\"booking-\".concat(value.id)},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image_container\"},/*#__PURE__*/React.createElement(\"img\",{src:value.doctor?IMAGE_ENDPOINT+value.doctor.image:Placeholder,alt:\"avatar\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md text-md-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"title-h2\"},\" \",value.doctor?value.doctor.name:\"N/A\",\"(THERAPIST)\")),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Booking Date:\"),\" \",value.book_date?value.book_date.split(\"T\")[0]:\"\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-7\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Timeslot:\"),\" \",value.timeslot)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5 description\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Status:\"),\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-primary\"},value.status))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 text-right mt-3 mt-md-0\"},value.status.toLowerCase()===\"accepted\"&&/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary btn-sm w-auto mr-2\",onClick:function onClick(){return _this2.gotoPayment(value.id);}},\"Pay Now\"),value.status.toLowerCase()===\"paid\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary btn-sm w-auto\",onClick:function onClick(){return _this2.gotoChat(value);}},\"Chat\")))))));}),list.length<=0&&/*#__PURE__*/React.createElement(\"p\",null,\"You dont have any bookings yet.\")))))),/*#__PURE__*/React.createElement(Footer,null));}}]);return MyBookings;}(Component);export default MyBookings;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/MyBookings.js"],"names":["React","Component","axios","Header","Footer","API_ENDPOINT","IMAGE_ENDPOINT","AppString","myFirestore","Placeholder","MyBookings","props","getAppointments","get","withCredentials","then","response","status","data","bookings","setState","list","catch","error","console","log","gotoPayment","id","history","push","gotoChat","booking","user","state","loggedInStatus","handleLogout","map","value","index","doctor","image","name","book_date","split","timeslot","toLowerCase","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport { API_ENDPOINT, IMAGE_ENDPOINT, AppString } from \"../../constant\";\r\nimport { myFirestore } from \"../../Config/MyFirebase\";\r\nimport Placeholder from '../../assets/img/profile-placeholder.png';\r\n\r\nclass MyBookings extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      list: [],\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getAppointments();\r\n  }\r\n\r\n  getAppointments = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/bookings`, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          var data = response.data.bookings;\r\n          this.setState({ list: data });\r\n        }\r\n      })\r\n      .catch((error) => console.log(error));\r\n  };\r\n\r\n  gotoPayment = (id) => {\r\n    this.props.history.push(\"/pay\", { id: id });\r\n  };\r\n\r\n  gotoChat = async (booking) => {\r\n    const { user } = this.props;\r\n\r\n    console.log(\"Child Page User\", user)\r\n    // Process Patient\r\n    // const result = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", user.id)\r\n    //   .get();\r\n\r\n    // console.log(\"Firebase Result: \", result);\r\n\r\n    // if (result.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(user.id.toString())\r\n    //     .set({\r\n    //       id: user.id,\r\n    //       nickname: `${user.first_name} ${user.last_name}`,\r\n    //       aboutMe: \"PATIENT\",\r\n    //       photoUrl: IMAGE_ENDPOINT + user.image,\r\n    //       friends: [booking.doctor.id],\r\n    //     });\r\n    // } else {\r\n    //   if (result.docs[0].data().friends.indexOf(booking.doctor.id) < 0) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(user.id.toString())\r\n    //       .set({\r\n    //         friends: [booking.doctor.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n\r\n    // Process Therapist\r\n    // const resultTherapist = await myFirestore\r\n    //   .collection(AppString.NODE_USERS)\r\n    //   .where(AppString.ID, \"==\", booking.doctor.id)\r\n    //   .get();\r\n\r\n    // if (resultTherapist.docs.length === 0) {\r\n    //   // Set new data since this is a new user\r\n    //   await myFirestore\r\n    //     .collection(\"users\")\r\n    //     .doc(booking.doctor.id.toString())\r\n    //     .set({\r\n    //       id: booking.doctor.id,\r\n    //       nickname: booking.doctor.name,\r\n    //       aboutMe: \"THERAPIST\",\r\n    //       photoUrl: IMAGE_ENDPOINT + booking.doctor.image,\r\n    //       friends: [user.id],\r\n    //     });\r\n    // } else {\r\n    //   if (\r\n    //     resultTherapist.docs[0].data().friends.indexOf(user.id) < 0\r\n    //   ) {\r\n    //     await myFirestore\r\n    //       .collection(\"users\")\r\n    //       .doc(booking.doctor.id.toString())\r\n    //       .set({\r\n    //         friends: [user.id],\r\n    //         merge: true,\r\n    //       });\r\n    //   }\r\n    // }\r\n    this.props.history.push(\"/main\", { id: user.id });\r\n  };\r\n\r\n  render() {\r\n    const { loggedInStatus, user, handleLogout } = this.props;\r\n    const { list } = this.state;\r\n\r\n    console.log(\"Booking Pages Props: \", this.props)\r\n\r\n    return (\r\n      <div>\r\n        <Header loggedInStatus={loggedInStatus} user={user} isInner={true} handleLogout={handleLogout} />\r\n        <section id=\"therapists\">\r\n          <div className=\"container\">\r\n            <div className=\"therapists-content pt-5 pb-2\">\r\n              <div className=\"row\">\r\n                <div className=\"col-md-12\">\r\n                  <div className=\"text-center pt-5 pb-2\">\r\n                    <h2> My Bookings  </h2>\r\n                  </div>\r\n                  <hr />\r\n                </div>\r\n\r\n                <div className=\"col-md-12\">\r\n                  {list.map((value, index) => {\r\n                    return (\r\n                      <div\r\n                        className=\"card card-height height-auto\"\r\n                        key={`booking-${value.id}`}  >\r\n                        <div className=\"row\">\r\n                          <div className=\"col-md-auto\">\r\n                            <div className=\"image_container\">\r\n                              <img\r\n                                src={\r\n                                  value.doctor\r\n                                    ? IMAGE_ENDPOINT + value.doctor.image : Placeholder\r\n                                }\r\n                                alt=\"avatar\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"col-md text-md-left\">\r\n                            <div className=\"title\">\r\n                              <h2 className=\"title-h2\">\r\n                                {\" \"}\r\n                                {value.doctor ? value.doctor.name : \"N/A\"}\r\n                                (THERAPIST)\r\n                              </h2>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5\">\r\n                                <strong>Booking Date:</strong>{\" \"}\r\n                                {value.book_date\r\n                                  ? value.book_date.split(\"T\")[0]\r\n                                  : \"\"}\r\n                              </div>\r\n                              <div className=\"col-md-7\">\r\n                                <strong>Timeslot:</strong> {value.timeslot}\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-5 description\">\r\n                                <strong>Status:</strong>{\" \"}\r\n                                <span className=\"badge badge-primary\">\r\n                                  {value.status}\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                              <div className=\"col-md-12 text-right mt-3 mt-md-0\">\r\n                                {value.status.toLowerCase() === \"accepted\" && (\r\n                                  <button\r\n                                    className=\"btn btn-primary btn-sm w-auto mr-2\"\r\n                                    onClick={() => this.gotoPayment(value.id)}\r\n                                  >\r\n                                    Pay Now\r\n                                  </button>\r\n                                )}\r\n                                {value.status.toLowerCase() === \"paid\" && (\r\n                                  <>\r\n                                  <button\r\n                                    className=\"btn btn-primary btn-sm w-auto\"\r\n                                    onClick={() => this.gotoChat(value)}\r\n                                  >\r\n                                    Chat\r\n                                  </button>\r\n                                  </>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                  {list.length <= 0 && <p>You dont have any bookings yet.</p>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MyBookings;\r\n"]},"metadata":{},"sourceType":"module"}