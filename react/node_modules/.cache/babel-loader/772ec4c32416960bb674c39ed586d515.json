{"ast":null,"code":"import _defineProperty from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import ReactChipInput from\"react-chip-input\";import Header from\"../Header\";import Footer from\"../Footer\";import\"./MyProfile.css\";import placeholder from\"./../../assets/img/profile-placeholder.png\";import{API_ENDPOINT,IMAGE_ENDPOINT}from\"../../constant\";var TherapistProfile=/*#__PURE__*/function(_Component){_inherits(TherapistProfile,_Component);var _super=_createSuper(TherapistProfile);function TherapistProfile(props){var _this;_classCallCheck(this,TherapistProfile);_this=_super.call(this,props);_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();var _this$state=_this.state,description=_this$state.description,name=_this$state.name,fees=_this$state.fees,userRes=_this$state.userRes;axios.put(\"\".concat(API_ENDPOINT,\"/doctors/\").concat(userRes.doctor.id),{name:name,description:description,fees:fees},{withCredentials:true}).then(function(response){if(response.status===200){}else{_this.setState({errors:response.data.errors});}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.loginStatus=function(){axios.get(\"\".concat(API_ENDPOINT,\"/logged_in\"),{withCredentials:true}).then(function(response){if(response.data.logged_in){_this.handleLogin(response);var chips=[];var ids=[];response.data.user.doctor.treatments.forEach(function(element){chips.push(element.name);ids.push(element.id);});_this.setState({chips:chips});_this.setState({ids:ids});}else{_this.handleLogout();}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.handleLogin=function(data){_this.setState({userRes:data.data.user,name:data.data.user.doctor.name,fees:data.data.user.doctor.fees,description:data.data.user.doctor.description,image:data.data.user.image,cert:data.data.user.doctor.certificate?IMAGE_ENDPOINT+data.data.user.doctor.certificate:\"\"});};_this.handleLogout=function(){_this.setState({userRes:{}});};_this.addChip=function(value){var _this$state2=_this.state,userRes=_this$state2.userRes,ids=_this$state2.ids;axios.post(\"\".concat(API_ENDPOINT,\"/doctors/\").concat(userRes.doctor.id,\"/treatments\"),{treatment:{name:value}},{withCredentials:true}).then(function(response){var chips=_this.state.chips.slice();chips.push(value);_this.setState({chips:chips});ids.push(response.data.treatment.id);_this.setState({ids:ids});}).catch(function(response){console.log(response);});};_this.removeChip=function(index){var _this$state3=_this.state,userRes=_this$state3.userRes,ids=_this$state3.ids;axios.delete(\"\".concat(API_ENDPOINT,\"/doctors/\").concat(userRes.doctor.id,\"/treatments/\").concat(ids[index]),{},{withCredentials:true}).then(function(response){var chips=_this.state.chips.slice();chips.splice(index,1);_this.setState({chips:chips});var ids=_this.state.ids.slice();ids.splice(index,1);_this.setState({ids:ids});}).catch(function(response){console.log(response);});};_this.state={userRes:{},name:\"\",description:\"\",fees:\"\",chips:[],ids:[],file:\"\",imagePreviewUrl:\"\",errors:\"\"};return _this;}_createClass(TherapistProfile,[{key:\"componentDidMount\",value:function componentDidMount(){this.loginStatus();}},{key:\"_handleSubmit\",value:function _handleSubmit(e){var _this2=this;e.preventDefault();var userRes=this.state.userRes;var imageData=new FormData();imageData.append(\"user[avatar]\",this.state.file);axios.put(\"\".concat(API_ENDPOINT,\"/users/\").concat(userRes.id),imageData,{\"Content-Type\":\"multipart/form-data\",withCredentials:true}).then(function(response){if(response.status===200||response.status===204){_this2.redirect();}}).catch(function(response){console.log(response);});}},{key:\"_handleImageChange\",value:function _handleImageChange(e){var _this3=this;e.preventDefault();var reader=new FileReader();var file=e.target.files[0];reader.onloadend=function(){_this3.setState({file:file,imagePreviewUrl:reader.result});};reader.readAsDataURL(file);}},{key:\"render\",value:function render(){var _this4=this;var _this$props=this.props,loggedInStatus=_this$props.loggedInStatus,user=_this$props.user,handleLogout=_this$props.handleLogout;var _this$state4=this.state,description=_this$state4.description,name=_this$state4.name,fees=_this$state4.fees,cert=_this$state4.cert,chips=_this$state4.chips,imagePreviewUrl=_this$state4.imagePreviewUrl,image=_this$state4.image;var $imagePreview=null;if(imagePreviewUrl){$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:imagePreviewUrl,alt:\"\"});}else{$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:image?IMAGE_ENDPOINT+image:placeholder,alt:\"upload profile\"});}return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,{loggedInStatus:loggedInStatus,user:user,isInner:true,handleLogout:handleLogout}),/*#__PURE__*/React.createElement(\"section\",{id:\"therapists\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container py-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"previewComponent pt-5\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return _this4._handleSubmit(e);}},/*#__PURE__*/React.createElement(\"div\",{className:\"image_container mx-auto mb-4\"},$imagePreview),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",className:\"form-control\",onChange:function onChange(e){return _this4._handleImageChange(e);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",type:\"submit\",onClick:function onClick(e){return _this4._handleSubmit(e);}},\"Upload Image\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"a\",{href:cert,target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn btn-secondary\"},\"View Certificate\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8 col-lg-8\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"h3 my-5\"},\"Therapist Profile\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Full Name\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"name\",placeholder:\"Name\",required:\"required\",value:name,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"About Me\"),/*#__PURE__*/React.createElement(\"textarea\",{rows:\"5\",className:\"form-control\",name:\"description\",placeholder:\"Please describe about yourself...\",required:\"required\",maxLength:\"500\",value:description,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Specialization\"),/*#__PURE__*/React.createElement(ReactChipInput,{classes:\"uc-chips\",chips:chips,onSubmit:function onSubmit(value){return _this4.addChip(value);},onRemove:function onRemove(index){return _this4.removeChip(index);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Fees\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",min:\"1\",className:\"form-control\",name:\"fees\",placeholder:\"Fees\",required:\"required\",value:fees,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary w-auto\"},\"Update\"))))))),/*#__PURE__*/React.createElement(Footer,null));}}]);return TherapistProfile;}(Component);export default TherapistProfile;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistProfile.js"],"names":["React","Component","axios","ReactChipInput","Header","Footer","placeholder","API_ENDPOINT","IMAGE_ENDPOINT","TherapistProfile","props","handleChange","event","target","name","value","setState","handleSubmit","preventDefault","state","description","fees","userRes","put","doctor","id","withCredentials","then","response","status","errors","data","catch","error","console","log","loginStatus","get","logged_in","handleLogin","chips","ids","user","treatments","forEach","element","push","handleLogout","image","cert","certificate","addChip","post","treatment","slice","removeChip","index","delete","splice","file","imagePreviewUrl","e","imageData","FormData","append","redirect","reader","FileReader","files","onloadend","result","readAsDataURL","loggedInStatus","$imagePreview","_handleSubmit","_handleImageChange"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport ReactChipInput from \"react-chip-input\";\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport \"./MyProfile.css\";\r\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\r\nimport { API_ENDPOINT, IMAGE_ENDPOINT } from \"../../constant\";\r\n\r\nclass TherapistProfile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userRes: {},\r\n      name: \"\",\r\n      description: \"\",\r\n      fees: \"\",\r\n      chips: [],\r\n      ids: [],\r\n      file: \"\",\r\n      imagePreviewUrl: \"\",\r\n      errors: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loginStatus();\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const { description, name, fees, userRes } = this.state;\r\n\r\n    axios\r\n      .put(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}`,\r\n        {\r\n          name: name,\r\n          description: description,\r\n          fees: fees,\r\n        },\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n        } else {\r\n          this.setState({\r\n            errors: response.data.errors,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  loginStatus = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/logged_in`, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.data.logged_in) {\r\n          this.handleLogin(response);\r\n          let chips = [];\r\n          let ids = [];\r\n          response.data.user.doctor.treatments.forEach((element) => {\r\n            chips.push(element.name);\r\n            ids.push(element.id);\r\n          });\r\n          this.setState({ chips: chips });\r\n          this.setState({ ids: ids });\r\n        } else {\r\n          this.handleLogout();\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  handleLogin = (data) => {\r\n    this.setState({\r\n      userRes: data.data.user,\r\n      name: data.data.user.doctor.name,\r\n      fees: data.data.user.doctor.fees,\r\n      description: data.data.user.doctor.description,\r\n      image: data.data.user.image,\r\n      cert: data.data.user.doctor.certificate\r\n        ? IMAGE_ENDPOINT + data.data.user.doctor.certificate\r\n        : \"\",\r\n    });\r\n  };\r\n\r\n  _handleSubmit(e) {\r\n    e.preventDefault();\r\n    const { userRes } = this.state;\r\n    var imageData = new FormData();\r\n    imageData.append(\"user[avatar]\", this.state.file);\r\n    axios\r\n      .put(`${API_ENDPOINT}/users/${userRes.id}`, imageData, {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n        withCredentials: true,\r\n      })\r\n      .then((response) => {\r\n        if (response.status === 200 || response.status === 204) {\r\n          this.redirect();\r\n        }\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  }\r\n\r\n  _handleImageChange(e) {\r\n    e.preventDefault();\r\n\r\n    let reader = new FileReader();\r\n    let file = e.target.files[0];\r\n\r\n    reader.onloadend = () => {\r\n      this.setState({\r\n        file: file,\r\n        imagePreviewUrl: reader.result,\r\n      });\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  handleLogout = () => {\r\n    this.setState({\r\n      userRes: {},\r\n    });\r\n  };\r\n\r\n  addChip = (value) => {\r\n    const { userRes, ids } = this.state;\r\n    axios\r\n      .post(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments`,\r\n        { treatment: { name: value } },\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        const chips = this.state.chips.slice();\r\n        chips.push(value);\r\n        this.setState({ chips });\r\n        ids.push(response.data.treatment.id);\r\n        this.setState({ ids });\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  };\r\n\r\n  removeChip = (index) => {\r\n    const { userRes, ids } = this.state;\r\n    axios\r\n      .delete(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments/${ids[index]}`,\r\n        {},\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        const chips = this.state.chips.slice();\r\n        chips.splice(index, 1);\r\n        this.setState({ chips });\r\n        const ids = this.state.ids.slice();\r\n        ids.splice(index, 1);\r\n        this.setState({ ids });\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const { loggedInStatus, user, handleLogout } = this.props;\r\n    const {\r\n      description,\r\n      name,\r\n      fees,\r\n      cert,\r\n      chips,\r\n      imagePreviewUrl,\r\n      image,\r\n    } = this.state;\r\n    let $imagePreview = null;\r\n    if (imagePreviewUrl) {\r\n      $imagePreview = <img src={imagePreviewUrl} alt=\"\" />;\r\n    } else {\r\n      $imagePreview = (\r\n        <img\r\n          src={image ? IMAGE_ENDPOINT + image : placeholder}\r\n          alt=\"upload profile\"\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <Header\r\n          loggedInStatus={loggedInStatus}\r\n          user={user}\r\n          isInner={true}\r\n          handleLogout={handleLogout}\r\n        />\r\n        <section id=\"therapists\">\r\n          <div className=\"container py-5\">\r\n            <div className=\"row\">\r\n              <div className=\"col-md-4\">\r\n                <div className=\"previewComponent pt-5\">\r\n                  <form onSubmit={(e) => this._handleSubmit(e)}>\r\n                    <div className=\"image_container mx-auto mb-4\">\r\n                      {$imagePreview}\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"file\"\r\n                        className=\"form-control\"\r\n                        onChange={(e) => this._handleImageChange(e)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <button\r\n                        className=\"btn btn-primary\"\r\n                        type=\"submit\"\r\n                        onClick={(e) => this._handleSubmit(e)}\r\n                      >\r\n                        Upload Image\r\n                      </button>\r\n                      <hr />\r\n                      <a\r\n                        href={cert}\r\n                        target=\"_blank\" rel=\"noopener noreferrer\"\r\n                        className=\"btn btn-secondary\"\r\n                      >\r\n                        View Certificate\r\n                      </a>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n              <div className=\"col-md-8 col-lg-8\">\r\n                <h1 className=\"h3 my-5\">Therapist Profile</h1>\r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <label>Full Name</label>\r\n                    <input\r\n                      className=\"form-control\"\r\n                      name=\"name\"\r\n                      placeholder=\"Name\"\r\n                      required=\"required\"\r\n                      value={name}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>About Me</label>\r\n                    <textarea\r\n                      rows=\"5\"\r\n                      className=\"form-control\"\r\n                      name=\"description\"\r\n                      placeholder=\"Please describe about yourself...\"\r\n                      required=\"required\"\r\n                      maxLength=\"500\"\r\n                      value={description}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>Specialization</label>\r\n                    <ReactChipInput\r\n                      classes=\"uc-chips\"\r\n                      chips={chips}\r\n                      onSubmit={(value) => this.addChip(value)}\r\n                      onRemove={(index) => this.removeChip(index)}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>Fees</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      className=\"form-control\"\r\n                      name=\"fees\"\r\n                      placeholder=\"Fees\"\r\n                      required=\"required\"\r\n                      value={fees}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <button type=\"submit\" className=\"btn btn-primary w-auto\">\r\n                      Update\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TherapistProfile;\r\n"]},"metadata":{},"sourceType":"module"}