{"ast":null,"code":"import _defineProperty from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{Link}from\"react-router-dom\";import{API_ENDPOINT}from\"../../constant\";import\"./Login.css\";import therapistbg from\"../../assets/img/therapist.jpg\";import patientbg from\"../../assets/img/patient.jpg\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();var _this$state=_this.state,username=_this$state.username,password=_this$state.password;var user={username:username,password:password};axios.post(\"\".concat(API_ENDPOINT,\"/login\"),{user:user},{withCredentials:true}).then(function(response){if(response.data.logged_in){response.data.user[\"doctor\"]={};response.data.user[\"doctor\"][\"id\"]=response.data.user.doctor_id;response.data.user[\"doctor\"][\"name\"]=response.data.user.first_name;_this.props.handleLogin(response.data);_this.props.showToast(1,\"Login successfull.\");_this.redirect(response.data.user);}else{_this.props.showToast(2,\"Invalid username or password.\");_this.setState({errors:response.data.errors});}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.redirect=function(user){if(user.role.toLowerCase()===\"therapist\"){_this.props.history.push(\"/dashboard\");}else if(user.role.toLowerCase()===\"superadmin\"){_this.props.history.push(\"/admin\");}else{_this.props.history.push(\"/doctors/psychiatrist\");}};_this.handleErrors=function(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"ul\",null,_this.state.errors.map(function(error){return/*#__PURE__*/React.createElement(\"li\",{key:error},error);})));};_this.state={username:\"\",email:\"\",password:\"\",role:\"\",errors:\"\"};return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var role=this.props.match.params.role;this.setState({role:role});}},{key:\"render\",value:function render(){var _this$state2=this.state,username=_this$state2.username,password=_this$state2.password,role=_this$state2.role;return/*#__PURE__*/React.createElement(\"div\",{className:\"login_form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid bg-white h-100 overflow-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row h-100 justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-7 d-none d-lg-block\",style:{backgroundImage:\"url(\"+(role&&role.toLowerCase()===\"therapist\"?therapistbg:patientbg)+\")\",backgroundPosition:\"center\",backgroundSize:\"cover\",backgroundRepeat:\"no-repeat\"}}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-5 col-md-8 p-5\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"h2\"},\"Login\"),/*#__PURE__*/React.createElement(\"p\",{className:\"text-muted\"},\"Sign In to your account\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Username\",name:\"username\",value:username,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Password\",name:\"password\",value:password,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-block btn-primary\"},\"Login\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 text-center\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn bg-white px-0 text-primary\"},\"Forgot password?\"))))),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Sign up\"),/*#__PURE__*/React.createElement(\"p\",null,\"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\"),/*#__PURE__*/React.createElement(Link,{className:\"btn btn-primary btn-block\",to:\"/auth/register/patient\"},\"As Patient\"),/*#__PURE__*/React.createElement(\"div\",{className:\"uc-divider text-center\"},/*#__PURE__*/React.createElement(\"span\",null,\"OR\")),/*#__PURE__*/React.createElement(Link,{className:\"btn btn-primary btn-block\",to:\"/auth/register/therapist\"},\"As Therapist\"))))));}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/auth/Login.js"],"names":["React","Component","axios","Link","API_ENDPOINT","therapistbg","patientbg","Login","props","handleChange","event","target","name","value","setState","handleSubmit","preventDefault","state","username","password","user","post","withCredentials","then","response","data","logged_in","doctor_id","first_name","handleLogin","showToast","redirect","errors","catch","error","console","log","role","toLowerCase","history","push","handleErrors","map","email","match","params","backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { API_ENDPOINT } from \"../../constant\";\r\nimport \"./Login.css\";\r\nimport therapistbg from \"../../assets/img/therapist.jpg\";\r\nimport patientbg from \"../../assets/img/patient.jpg\";\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      role: \"\",\r\n      errors: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { role } = this.props.match.params;\r\n    this.setState({ role: role });\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const { username, password } = this.state;\r\n    let user = {\r\n      username: username,\r\n      password: password,\r\n    };\r\n\r\n    axios\r\n      .post(`${API_ENDPOINT}/login`, { user }, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.data.logged_in) {\r\n          response.data.user[\"doctor\"] = {};\r\n          response.data.user[\"doctor\"][\"id\"] = response.data.user.doctor_id;\r\n          response.data.user[\"doctor\"][\"name\"] = response.data.user.first_name;\r\n          this.props.handleLogin(response.data);\r\n          this.props.showToast(1, \"Login successfull.\");\r\n          this.redirect(response.data.user);\r\n        } else {\r\n          this.props.showToast(2, \"Invalid username or password.\");\r\n          this.setState({\r\n            errors: response.data.errors,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  redirect = (user) => {\r\n    if (user.role.toLowerCase() === \"therapist\") {\r\n      this.props.history.push(\"/dashboard\");\r\n    } else if (user.role.toLowerCase() === \"superadmin\") {\r\n      this.props.history.push(\"/admin\");\r\n    } else {\r\n      this.props.history.push(\"/doctors/psychiatrist\");\r\n    }\r\n  };\r\n\r\n  handleErrors = () => {\r\n    return (\r\n      <div>\r\n        <ul>\r\n          {this.state.errors.map((error) => {\r\n            return <li key={error}>{error}</li>;\r\n          })}\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { username, password, role } = this.state;\r\n    return (\r\n      <div className=\"login_form\">\r\n        <div className=\"container-fluid bg-white h-100 overflow-auto\">\r\n          <div className=\"row h-100 justify-content-center\">\r\n            <div\r\n              className=\"col-lg-7 d-none d-lg-block\"\r\n              style={{\r\n                backgroundImage: \"url(\" + (role && role.toLowerCase() === \"therapist\" ? therapistbg : patientbg) + \")\",\r\n                backgroundPosition: \"center\",\r\n                backgroundSize: \"cover\",\r\n                backgroundRepeat: \"no-repeat\",\r\n              }}\r\n            ></div>\r\n            <div className=\"col-lg-5 col-md-8 p-5\">\r\n              <div>\r\n                <h1 className=\"h2\">Login</h1>\r\n                <p className=\"text-muted\">Sign In to your account</p>\r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      placeholder=\"Username\"\r\n                      name=\"username\"\r\n                      value={username}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <input\r\n                      type=\"password\"\r\n                      className=\"form-control\"\r\n                      placeholder=\"Password\"\r\n                      name=\"password\"\r\n                      value={password}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"row\">\r\n                    <div className=\"col-sm-12\">\r\n                      <div className=\"form-group\">\r\n                        <button type=\"submit\" className=\"btn btn-block btn-primary\">\r\n                          Login\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"col-sm-12 text-center\">\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"btn bg-white px-0 text-primary\"\r\n                      >\r\n                        Forgot password?\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n              <hr />\r\n              <div>\r\n                <h2>Sign up</h2>\r\n                <p>\r\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed\r\n                  do eiusmod tempor incididunt ut labore et dolore magna aliqua.\r\n                </p>\r\n                <Link className=\"btn btn-primary btn-block\" to=\"/auth/register/patient\">\r\n                  As Patient\r\n                </Link>\r\n                <div className=\"uc-divider text-center\">\r\n                  <span>OR</span>\r\n                </div>\r\n                <Link className=\"btn btn-primary btn-block\" to=\"/auth/register/therapist\">\r\n                  As Therapist\r\n                </Link>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}