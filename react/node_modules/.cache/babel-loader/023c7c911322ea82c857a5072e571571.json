{"ast":null,"code":"var _jsxFileName = \"/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistProfile.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport ReactChipInput from \"react-chip-input\";\nimport Header from \"../Header\";\nimport Footer from \"../Footer\";\nimport \"./MyProfile.css\";\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\nimport { API_ENDPOINT, IMAGE_ENDPOINT } from \"../../constant\";\n\nclass TherapistProfile extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = event => {\n      const {\n        name,\n        value\n      } = event.target;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      const {\n        description,\n        name,\n        fees,\n        userRes\n      } = this.state;\n      axios.put(`${API_ENDPOINT}/doctors/${userRes.doctor.id}`, {\n        name: name,\n        description: description,\n        fees: fees\n      }, {\n        withCredentials: true\n      }).then(response => {\n        if (response.status === 200) {} else {\n          this.setState({\n            errors: response.data.errors\n          });\n        }\n      }).catch(error => console.log(\"api errors:\", error));\n    };\n\n    this.loginStatus = () => {\n      axios.get(`${API_ENDPOINT}/logged_in`, {\n        withCredentials: true\n      }).then(response => {\n        if (response.data.logged_in) {\n          this.handleLogin(response);\n          let chips = [];\n          let ids = [];\n          response.data.user.doctor.treatments.forEach(element => {\n            chips.push(element.name);\n            ids.push(element.id);\n          });\n          this.setState({\n            chips: chips\n          });\n          this.setState({\n            ids: ids\n          });\n        } else {\n          this.handleLogout();\n        }\n      }).catch(error => console.log(\"api errors:\", error));\n    };\n\n    this.handleLogin = data => {\n      this.setState({\n        userRes: data.data.user,\n        name: data.data.user.doctor.name,\n        fees: data.data.user.doctor.fees,\n        description: data.data.user.doctor.description,\n        image: data.data.user.image,\n        cert: data.data.user.doctor.certificate ? IMAGE_ENDPOINT + data.data.user.doctor.certificate : \"\"\n      });\n    };\n\n    this.handleLogout = () => {\n      this.setState({\n        userRes: {}\n      });\n    };\n\n    this.addChip = value => {\n      const {\n        userRes,\n        ids\n      } = this.state;\n      axios.post(`${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments`, {\n        treatment: {\n          name: value\n        }\n      }, {\n        withCredentials: true\n      }).then(response => {\n        const chips = this.state.chips.slice();\n        chips.push(value);\n        this.setState({\n          chips\n        });\n        ids.push(response.data.treatment.id);\n        this.setState({\n          ids\n        });\n      }).catch(response => {\n        console.log(response);\n      });\n    };\n\n    this.removeChip = index => {\n      const {\n        userRes,\n        ids\n      } = this.state;\n      axios.delete(`${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments/${ids[index]}`, {}, {\n        withCredentials: true\n      }).then(response => {\n        const chips = this.state.chips.slice();\n        chips.splice(index, 1);\n        this.setState({\n          chips\n        });\n        const ids = this.state.ids.slice();\n        ids.splice(index, 1);\n        this.setState({\n          ids\n        });\n      }).catch(response => {\n        console.log(response);\n      });\n    };\n\n    this.state = {\n      userRes: {},\n      name: \"\",\n      description: \"\",\n      fees: \"\",\n      chips: [],\n      ids: [],\n      file: \"\",\n      imagePreviewUrl: \"\",\n      errors: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.loginStatus();\n  }\n\n  _handleSubmit(e) {\n    e.preventDefault();\n    const {\n      userRes\n    } = this.state;\n    var imageData = new FormData();\n    imageData.append(\"user[avatar]\", this.state.file);\n    axios.put(`${API_ENDPOINT}/users/${userRes.id}`, imageData, {\n      \"Content-Type\": \"multipart/form-data\",\n      withCredentials: true\n    }).then(response => {\n      if (response.status === 200 || response.status === 204) {\n        this.redirect();\n      }\n    }).catch(response => {\n      console.log(response);\n    });\n  }\n\n  _handleImageChange(e) {\n    e.preventDefault();\n    let reader = new FileReader();\n    let file = e.target.files[0];\n\n    reader.onloadend = () => {\n      this.setState({\n        file: file,\n        imagePreviewUrl: reader.result\n      });\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  render() {\n    const {\n      loggedInStatus,\n      user,\n      handleLogout\n    } = this.props;\n    const {\n      description,\n      name,\n      fees,\n      cert,\n      chips,\n      imagePreviewUrl,\n      image\n    } = this.state;\n    let $imagePreview = null;\n\n    if (imagePreviewUrl) {\n      $imagePreview = /*#__PURE__*/React.createElement(\"img\", {\n        src: imagePreviewUrl,\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 23\n        }\n      });\n    } else {\n      $imagePreview = /*#__PURE__*/React.createElement(\"img\", {\n        src: image ? IMAGE_ENDPOINT + image : placeholder,\n        alt: \"upload profile\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 9\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      loggedInStatus: loggedInStatus,\n      user: user,\n      isInner: true,\n      handleLogout: handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"section\", {\n      id: \"therapists\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container py-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"previewComponent pt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: e => this._handleSubmit(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"image_container mx-auto mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 21\n      }\n    }, $imagePreview), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      className: \"form-control\",\n      onChange: e => this._handleImageChange(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      type: \"submit\",\n      onClick: e => this._handleSubmit(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 23\n      }\n    }, \"Upload Image\"), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"a\", {\n      href: cert,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      className: \"btn btn-secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 23\n      }\n    }, \"View Certificate\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-8 col-lg-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"h3 my-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 17\n      }\n    }, \"Therapist Profile\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }\n    }, \"Full Name\"), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"form-control\",\n      name: \"name\",\n      placeholder: \"Name\",\n      required: \"required\",\n      value: name,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 21\n      }\n    }, \"About Me\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      rows: \"5\",\n      className: \"form-control\",\n      name: \"description\",\n      placeholder: \"Please describe about yourself...\",\n      required: \"required\",\n      maxLength: \"500\",\n      value: description,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 21\n      }\n    }, \"Specialization\"), /*#__PURE__*/React.createElement(ReactChipInput, {\n      classes: \"uc-chips\",\n      chips: chips,\n      onSubmit: value => this.addChip(value),\n      onRemove: index => this.removeChip(index),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 21\n      }\n    }, \"Fees\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"number\",\n      min: \"1\",\n      className: \"form-control\",\n      name: \"fees\",\n      placeholder: \"Fees\",\n      required: \"required\",\n      value: fees,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary w-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 21\n      }\n    }, \"Update\"))))))), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default TherapistProfile;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistProfile.js"],"names":["React","Component","axios","ReactChipInput","Header","Footer","placeholder","API_ENDPOINT","IMAGE_ENDPOINT","TherapistProfile","constructor","props","handleChange","event","name","value","target","setState","handleSubmit","preventDefault","description","fees","userRes","state","put","doctor","id","withCredentials","then","response","status","errors","data","catch","error","console","log","loginStatus","get","logged_in","handleLogin","chips","ids","user","treatments","forEach","element","push","handleLogout","image","cert","certificate","addChip","post","treatment","slice","removeChip","index","delete","splice","file","imagePreviewUrl","componentDidMount","_handleSubmit","e","imageData","FormData","append","redirect","_handleImageChange","reader","FileReader","files","onloadend","result","readAsDataURL","render","loggedInStatus","$imagePreview"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAO,iBAAP;AACA,OAAOC,WAAP,MAAwB,4CAAxB;AACA,SAASC,YAAT,EAAuBC,cAAvB,QAA6C,gBAA7C;;AAEA,MAAMC,gBAAN,SAA+BR,SAA/B,CAAyC;AACvCS,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAmBnBC,YAnBmB,GAmBHC,KAAD,IAAW;AACxB,YAAM;AAAEC,QAAAA,IAAF;AAAQC,QAAAA;AAAR,UAAkBF,KAAK,CAACG,MAA9B;AACA,WAAKC,QAAL,CAAc;AACZ,SAACH,IAAD,GAAQC;AADI,OAAd;AAGD,KAxBkB;;AAAA,SA0BnBG,YA1BmB,GA0BHL,KAAD,IAAW;AACxBA,MAAAA,KAAK,CAACM,cAAN;AACA,YAAM;AAAEC,QAAAA,WAAF;AAAeN,QAAAA,IAAf;AAAqBO,QAAAA,IAArB;AAA2BC,QAAAA;AAA3B,UAAuC,KAAKC,KAAlD;AAEArB,MAAAA,KAAK,CACFsB,GADH,CAEK,GAAEjB,YAAa,YAAWe,OAAO,CAACG,MAAR,CAAeC,EAAG,EAFjD,EAGI;AACEZ,QAAAA,IAAI,EAAEA,IADR;AAEEM,QAAAA,WAAW,EAAEA,WAFf;AAGEC,QAAAA,IAAI,EAAEA;AAHR,OAHJ,EAQI;AAAEM,QAAAA,eAAe,EAAE;AAAnB,OARJ,EAUGC,IAVH,CAUSC,QAAD,IAAc;AAClB,YAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B,CAC5B,CADD,MACO;AACL,eAAKb,QAAL,CAAc;AACZc,YAAAA,MAAM,EAAEF,QAAQ,CAACG,IAAT,CAAcD;AADV,WAAd;AAGD;AACF,OAjBH,EAkBGE,KAlBH,CAkBUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,KAA3B,CAlBpB;AAmBD,KAjDkB;;AAAA,SAmDnBG,WAnDmB,GAmDL,MAAM;AAClBnC,MAAAA,KAAK,CACFoC,GADH,CACQ,GAAE/B,YAAa,YADvB,EACoC;AAAEoB,QAAAA,eAAe,EAAE;AAAnB,OADpC,EAEGC,IAFH,CAESC,QAAD,IAAc;AAClB,YAAIA,QAAQ,CAACG,IAAT,CAAcO,SAAlB,EAA6B;AAC3B,eAAKC,WAAL,CAAiBX,QAAjB;AACA,cAAIY,KAAK,GAAG,EAAZ;AACA,cAAIC,GAAG,GAAG,EAAV;AACAb,UAAAA,QAAQ,CAACG,IAAT,CAAcW,IAAd,CAAmBlB,MAAnB,CAA0BmB,UAA1B,CAAqCC,OAArC,CAA8CC,OAAD,IAAa;AACxDL,YAAAA,KAAK,CAACM,IAAN,CAAWD,OAAO,CAAChC,IAAnB;AACA4B,YAAAA,GAAG,CAACK,IAAJ,CAASD,OAAO,CAACpB,EAAjB;AACD,WAHD;AAIA,eAAKT,QAAL,CAAc;AAAEwB,YAAAA,KAAK,EAAEA;AAAT,WAAd;AACA,eAAKxB,QAAL,CAAc;AAAEyB,YAAAA,GAAG,EAAEA;AAAP,WAAd;AACD,SAVD,MAUO;AACL,eAAKM,YAAL;AACD;AACF,OAhBH,EAiBGf,KAjBH,CAiBUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,KAA3B,CAjBpB;AAkBD,KAtEkB;;AAAA,SAwEnBM,WAxEmB,GAwEJR,IAAD,IAAU;AACtB,WAAKf,QAAL,CAAc;AACZK,QAAAA,OAAO,EAAEU,IAAI,CAACA,IAAL,CAAUW,IADP;AAEZ7B,QAAAA,IAAI,EAAEkB,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAelB,MAAf,CAAsBX,IAFhB;AAGZO,QAAAA,IAAI,EAAEW,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAelB,MAAf,CAAsBJ,IAHhB;AAIZD,QAAAA,WAAW,EAAEY,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAelB,MAAf,CAAsBL,WAJvB;AAKZ6B,QAAAA,KAAK,EAAEjB,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAeM,KALV;AAMZC,QAAAA,IAAI,EAAElB,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAelB,MAAf,CAAsB0B,WAAtB,GACF3C,cAAc,GAAGwB,IAAI,CAACA,IAAL,CAAUW,IAAV,CAAelB,MAAf,CAAsB0B,WADrC,GAEF;AARQ,OAAd;AAUD,KAnFkB;;AAAA,SAyHnBH,YAzHmB,GAyHJ,MAAM;AACnB,WAAK/B,QAAL,CAAc;AACZK,QAAAA,OAAO,EAAE;AADG,OAAd;AAGD,KA7HkB;;AAAA,SA+HnB8B,OA/HmB,GA+HRrC,KAAD,IAAW;AACnB,YAAM;AAAEO,QAAAA,OAAF;AAAWoB,QAAAA;AAAX,UAAmB,KAAKnB,KAA9B;AACArB,MAAAA,KAAK,CACFmD,IADH,CAEK,GAAE9C,YAAa,YAAWe,OAAO,CAACG,MAAR,CAAeC,EAAG,aAFjD,EAGI;AAAE4B,QAAAA,SAAS,EAAE;AAAExC,UAAAA,IAAI,EAAEC;AAAR;AAAb,OAHJ,EAII;AAAEY,QAAAA,eAAe,EAAE;AAAnB,OAJJ,EAMGC,IANH,CAMSC,QAAD,IAAc;AAClB,cAAMY,KAAK,GAAG,KAAKlB,KAAL,CAAWkB,KAAX,CAAiBc,KAAjB,EAAd;AACAd,QAAAA,KAAK,CAACM,IAAN,CAAWhC,KAAX;AACA,aAAKE,QAAL,CAAc;AAAEwB,UAAAA;AAAF,SAAd;AACAC,QAAAA,GAAG,CAACK,IAAJ,CAASlB,QAAQ,CAACG,IAAT,CAAcsB,SAAd,CAAwB5B,EAAjC;AACA,aAAKT,QAAL,CAAc;AAAEyB,UAAAA;AAAF,SAAd;AACD,OAZH,EAaGT,KAbH,CAaUJ,QAAD,IAAc;AACnBM,QAAAA,OAAO,CAACC,GAAR,CAAYP,QAAZ;AACD,OAfH;AAgBD,KAjJkB;;AAAA,SAmJnB2B,UAnJmB,GAmJLC,KAAD,IAAW;AACtB,YAAM;AAAEnC,QAAAA,OAAF;AAAWoB,QAAAA;AAAX,UAAmB,KAAKnB,KAA9B;AACArB,MAAAA,KAAK,CACFwD,MADH,CAEK,GAAEnD,YAAa,YAAWe,OAAO,CAACG,MAAR,CAAeC,EAAG,eAAcgB,GAAG,CAACe,KAAD,CAAQ,EAF1E,EAGI,EAHJ,EAII;AAAE9B,QAAAA,eAAe,EAAE;AAAnB,OAJJ,EAMGC,IANH,CAMSC,QAAD,IAAc;AAClB,cAAMY,KAAK,GAAG,KAAKlB,KAAL,CAAWkB,KAAX,CAAiBc,KAAjB,EAAd;AACAd,QAAAA,KAAK,CAACkB,MAAN,CAAaF,KAAb,EAAoB,CAApB;AACA,aAAKxC,QAAL,CAAc;AAAEwB,UAAAA;AAAF,SAAd;AACA,cAAMC,GAAG,GAAG,KAAKnB,KAAL,CAAWmB,GAAX,CAAea,KAAf,EAAZ;AACAb,QAAAA,GAAG,CAACiB,MAAJ,CAAWF,KAAX,EAAkB,CAAlB;AACA,aAAKxC,QAAL,CAAc;AAAEyB,UAAAA;AAAF,SAAd;AACD,OAbH,EAcGT,KAdH,CAcUJ,QAAD,IAAc;AACnBM,QAAAA,OAAO,CAACC,GAAR,CAAYP,QAAZ;AACD,OAhBH;AAiBD,KAtKkB;;AAEjB,SAAKN,KAAL,GAAa;AACXD,MAAAA,OAAO,EAAE,EADE;AAEXR,MAAAA,IAAI,EAAE,EAFK;AAGXM,MAAAA,WAAW,EAAE,EAHF;AAIXC,MAAAA,IAAI,EAAE,EAJK;AAKXoB,MAAAA,KAAK,EAAE,EALI;AAMXC,MAAAA,GAAG,EAAE,EANM;AAOXkB,MAAAA,IAAI,EAAE,EAPK;AAQXC,MAAAA,eAAe,EAAE,EARN;AASX9B,MAAAA,MAAM,EAAE;AATG,KAAb;AAWD;;AAED+B,EAAAA,iBAAiB,GAAG;AAClB,SAAKzB,WAAL;AACD;;AAoED0B,EAAAA,aAAa,CAACC,CAAD,EAAI;AACfA,IAAAA,CAAC,CAAC7C,cAAF;AACA,UAAM;AAAEG,MAAAA;AAAF,QAAc,KAAKC,KAAzB;AACA,QAAI0C,SAAS,GAAG,IAAIC,QAAJ,EAAhB;AACAD,IAAAA,SAAS,CAACE,MAAV,CAAiB,cAAjB,EAAiC,KAAK5C,KAAL,CAAWqC,IAA5C;AACA1D,IAAAA,KAAK,CACFsB,GADH,CACQ,GAAEjB,YAAa,UAASe,OAAO,CAACI,EAAG,EAD3C,EAC8CuC,SAD9C,EACyD;AACrD,sBAAgB,qBADqC;AAErDtC,MAAAA,eAAe,EAAE;AAFoC,KADzD,EAKGC,IALH,CAKSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAACC,MAAT,KAAoB,GAApB,IAA2BD,QAAQ,CAACC,MAAT,KAAoB,GAAnD,EAAwD;AACtD,aAAKsC,QAAL;AACD;AACF,KATH,EAUGnC,KAVH,CAUUJ,QAAD,IAAc;AACnBM,MAAAA,OAAO,CAACC,GAAR,CAAYP,QAAZ;AACD,KAZH;AAaD;;AAEDwC,EAAAA,kBAAkB,CAACL,CAAD,EAAI;AACpBA,IAAAA,CAAC,CAAC7C,cAAF;AAEA,QAAImD,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACA,QAAIX,IAAI,GAAGI,CAAC,CAAChD,MAAF,CAASwD,KAAT,CAAe,CAAf,CAAX;;AAEAF,IAAAA,MAAM,CAACG,SAAP,GAAmB,MAAM;AACvB,WAAKxD,QAAL,CAAc;AACZ2C,QAAAA,IAAI,EAAEA,IADM;AAEZC,QAAAA,eAAe,EAAES,MAAM,CAACI;AAFZ,OAAd;AAID,KALD;;AAOAJ,IAAAA,MAAM,CAACK,aAAP,CAAqBf,IAArB;AACD;;AAiDDgB,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA,cAAF;AAAkBlC,MAAAA,IAAlB;AAAwBK,MAAAA;AAAxB,QAAyC,KAAKrC,KAApD;AACA,UAAM;AACJS,MAAAA,WADI;AAEJN,MAAAA,IAFI;AAGJO,MAAAA,IAHI;AAIJ6B,MAAAA,IAJI;AAKJT,MAAAA,KALI;AAMJoB,MAAAA,eANI;AAOJZ,MAAAA;AAPI,QAQF,KAAK1B,KART;AASA,QAAIuD,aAAa,GAAG,IAApB;;AACA,QAAIjB,eAAJ,EAAqB;AACnBiB,MAAAA,aAAa,gBAAG;AAAK,QAAA,GAAG,EAAEjB,eAAV;AAA2B,QAAA,GAAG,EAAC,EAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAhB;AACD,KAFD,MAEO;AACLiB,MAAAA,aAAa,gBACX;AACE,QAAA,GAAG,EAAE7B,KAAK,GAAGzC,cAAc,GAAGyC,KAApB,GAA4B3C,WADxC;AAEE,QAAA,GAAG,EAAC,gBAFN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAMD;;AAED,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AACE,MAAA,cAAc,EAAEuE,cADlB;AAEE,MAAA,IAAI,EAAElC,IAFR;AAGE,MAAA,OAAO,EAAE,IAHX;AAIE,MAAA,YAAY,EAAEK,YAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAOE;AAAS,MAAA,EAAE,EAAC,YAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAM,MAAA,QAAQ,EAAGgB,CAAD,IAAO,KAAKD,aAAL,CAAmBC,CAAnB,CAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGc,aADH,CADF,eAIE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,SAAS,EAAC,cAFZ;AAGE,MAAA,QAAQ,EAAGd,CAAD,IAAO,KAAKK,kBAAL,CAAwBL,CAAxB,CAHnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAJF,eAWE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EAAC,iBADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,OAAO,EAAGA,CAAD,IAAO,KAAKD,aAAL,CAAmBC,CAAnB,CAHlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARF,eASE;AACE,MAAA,IAAI,EAAEd,IADR;AAEE,MAAA,MAAM,EAAC,QAFT;AAEkB,MAAA,GAAG,EAAC,qBAFtB;AAGE,MAAA,SAAS,EAAC,mBAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BATF,CAXF,CADF,CADF,CADF,eAkCE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADF,eAEE;AAAM,MAAA,QAAQ,EAAE,KAAKhC,YAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,eAEE;AACE,MAAA,SAAS,EAAC,cADZ;AAEE,MAAA,IAAI,EAAC,MAFP;AAGE,MAAA,WAAW,EAAC,MAHd;AAIE,MAAA,QAAQ,EAAC,UAJX;AAKE,MAAA,KAAK,EAAEJ,IALT;AAME,MAAA,QAAQ,EAAE,KAAKF,YANjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF,eAYE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AACE,MAAA,IAAI,EAAC,GADP;AAEE,MAAA,SAAS,EAAC,cAFZ;AAGE,MAAA,IAAI,EAAC,aAHP;AAIE,MAAA,WAAW,EAAC,mCAJd;AAKE,MAAA,QAAQ,EAAC,UALX;AAME,MAAA,SAAS,EAAC,KANZ;AAOE,MAAA,KAAK,EAAEQ,WAPT;AAQE,MAAA,QAAQ,EAAE,KAAKR,YARjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAZF,eAyBE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE,oBAAC,cAAD;AACE,MAAA,OAAO,EAAC,UADV;AAEE,MAAA,KAAK,EAAE6B,KAFT;AAGE,MAAA,QAAQ,EAAG1B,KAAD,IAAW,KAAKqC,OAAL,CAAarC,KAAb,CAHvB;AAIE,MAAA,QAAQ,EAAG0C,KAAD,IAAW,KAAKD,UAAL,CAAgBC,KAAhB,CAJvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAzBF,eAkCE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,GAAG,EAAC,GAFN;AAGE,MAAA,SAAS,EAAC,cAHZ;AAIE,MAAA,IAAI,EAAC,MAJP;AAKE,MAAA,WAAW,EAAC,MALd;AAME,MAAA,QAAQ,EAAC,UANX;AAOE,MAAA,KAAK,EAAEpC,IAPT;AAQE,MAAA,QAAQ,EAAE,KAAKT,YARjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAlCF,eA+CE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,wBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,CA/CF,CAFF,CAlCF,CADF,CADF,CAPF,eAsGE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAtGF,CADF;AA0GD;;AA1SsC;;AA6SzC,eAAeH,gBAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport ReactChipInput from \"react-chip-input\";\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport \"./MyProfile.css\";\r\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\r\nimport { API_ENDPOINT, IMAGE_ENDPOINT } from \"../../constant\";\r\n\r\nclass TherapistProfile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userRes: {},\r\n      name: \"\",\r\n      description: \"\",\r\n      fees: \"\",\r\n      chips: [],\r\n      ids: [],\r\n      file: \"\",\r\n      imagePreviewUrl: \"\",\r\n      errors: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loginStatus();\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const { description, name, fees, userRes } = this.state;\r\n\r\n    axios\r\n      .put(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}`,\r\n        {\r\n          name: name,\r\n          description: description,\r\n          fees: fees,\r\n        },\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n        } else {\r\n          this.setState({\r\n            errors: response.data.errors,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  loginStatus = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/logged_in`, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.data.logged_in) {\r\n          this.handleLogin(response);\r\n          let chips = [];\r\n          let ids = [];\r\n          response.data.user.doctor.treatments.forEach((element) => {\r\n            chips.push(element.name);\r\n            ids.push(element.id);\r\n          });\r\n          this.setState({ chips: chips });\r\n          this.setState({ ids: ids });\r\n        } else {\r\n          this.handleLogout();\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  handleLogin = (data) => {\r\n    this.setState({\r\n      userRes: data.data.user,\r\n      name: data.data.user.doctor.name,\r\n      fees: data.data.user.doctor.fees,\r\n      description: data.data.user.doctor.description,\r\n      image: data.data.user.image,\r\n      cert: data.data.user.doctor.certificate\r\n        ? IMAGE_ENDPOINT + data.data.user.doctor.certificate\r\n        : \"\",\r\n    });\r\n  };\r\n\r\n  _handleSubmit(e) {\r\n    e.preventDefault();\r\n    const { userRes } = this.state;\r\n    var imageData = new FormData();\r\n    imageData.append(\"user[avatar]\", this.state.file);\r\n    axios\r\n      .put(`${API_ENDPOINT}/users/${userRes.id}`, imageData, {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n        withCredentials: true,\r\n      })\r\n      .then((response) => {\r\n        if (response.status === 200 || response.status === 204) {\r\n          this.redirect();\r\n        }\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  }\r\n\r\n  _handleImageChange(e) {\r\n    e.preventDefault();\r\n\r\n    let reader = new FileReader();\r\n    let file = e.target.files[0];\r\n\r\n    reader.onloadend = () => {\r\n      this.setState({\r\n        file: file,\r\n        imagePreviewUrl: reader.result,\r\n      });\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  handleLogout = () => {\r\n    this.setState({\r\n      userRes: {},\r\n    });\r\n  };\r\n\r\n  addChip = (value) => {\r\n    const { userRes, ids } = this.state;\r\n    axios\r\n      .post(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments`,\r\n        { treatment: { name: value } },\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        const chips = this.state.chips.slice();\r\n        chips.push(value);\r\n        this.setState({ chips });\r\n        ids.push(response.data.treatment.id);\r\n        this.setState({ ids });\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  };\r\n\r\n  removeChip = (index) => {\r\n    const { userRes, ids } = this.state;\r\n    axios\r\n      .delete(\r\n        `${API_ENDPOINT}/doctors/${userRes.doctor.id}/treatments/${ids[index]}`,\r\n        {},\r\n        { withCredentials: true }\r\n      )\r\n      .then((response) => {\r\n        const chips = this.state.chips.slice();\r\n        chips.splice(index, 1);\r\n        this.setState({ chips });\r\n        const ids = this.state.ids.slice();\r\n        ids.splice(index, 1);\r\n        this.setState({ ids });\r\n      })\r\n      .catch((response) => {\r\n        console.log(response);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const { loggedInStatus, user, handleLogout } = this.props;\r\n    const {\r\n      description,\r\n      name,\r\n      fees,\r\n      cert,\r\n      chips,\r\n      imagePreviewUrl,\r\n      image,\r\n    } = this.state;\r\n    let $imagePreview = null;\r\n    if (imagePreviewUrl) {\r\n      $imagePreview = <img src={imagePreviewUrl} alt=\"\" />;\r\n    } else {\r\n      $imagePreview = (\r\n        <img\r\n          src={image ? IMAGE_ENDPOINT + image : placeholder}\r\n          alt=\"upload profile\"\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <Header\r\n          loggedInStatus={loggedInStatus}\r\n          user={user}\r\n          isInner={true}\r\n          handleLogout={handleLogout}\r\n        />\r\n        <section id=\"therapists\">\r\n          <div className=\"container py-5\">\r\n            <div className=\"row\">\r\n              <div className=\"col-md-4\">\r\n                <div className=\"previewComponent pt-5\">\r\n                  <form onSubmit={(e) => this._handleSubmit(e)}>\r\n                    <div className=\"image_container mx-auto mb-4\">\r\n                      {$imagePreview}\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"file\"\r\n                        className=\"form-control\"\r\n                        onChange={(e) => this._handleImageChange(e)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <button\r\n                        className=\"btn btn-primary\"\r\n                        type=\"submit\"\r\n                        onClick={(e) => this._handleSubmit(e)}\r\n                      >\r\n                        Upload Image\r\n                      </button>\r\n                      <hr />\r\n                      <a\r\n                        href={cert}\r\n                        target=\"_blank\" rel=\"noopener noreferrer\"\r\n                        className=\"btn btn-secondary\"\r\n                      >\r\n                        View Certificate\r\n                      </a>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n              <div className=\"col-md-8 col-lg-8\">\r\n                <h1 className=\"h3 my-5\">Therapist Profile</h1>\r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <label>Full Name</label>\r\n                    <input\r\n                      className=\"form-control\"\r\n                      name=\"name\"\r\n                      placeholder=\"Name\"\r\n                      required=\"required\"\r\n                      value={name}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>About Me</label>\r\n                    <textarea\r\n                      rows=\"5\"\r\n                      className=\"form-control\"\r\n                      name=\"description\"\r\n                      placeholder=\"Please describe about yourself...\"\r\n                      required=\"required\"\r\n                      maxLength=\"500\"\r\n                      value={description}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>Specialization</label>\r\n                    <ReactChipInput\r\n                      classes=\"uc-chips\"\r\n                      chips={chips}\r\n                      onSubmit={(value) => this.addChip(value)}\r\n                      onRemove={(index) => this.removeChip(index)}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label>Fees</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      className=\"form-control\"\r\n                      name=\"fees\"\r\n                      placeholder=\"Fees\"\r\n                      required=\"required\"\r\n                      value={fees}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <button type=\"submit\" className=\"btn btn-primary w-auto\">\r\n                      Update\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TherapistProfile;\r\n"]},"metadata":{},"sourceType":"module"}