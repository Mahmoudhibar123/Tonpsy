{"ast":null,"code":"import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{API_ENDPOINT}from\"../../constant\";import placeholder from\"./../../assets/img/profile-placeholder.png\";var ProfileImage=/*#__PURE__*/function(_Component){_inherits(ProfileImage,_Component);var _super=_createSuper(ProfileImage);function ProfileImage(props){var _this;_classCallCheck(this,ProfileImage);_this=_super.call(this,props);_this.loginStatus=function(){axios.get(\"\".concat(API_ENDPOINT,\"/logged_in\"),{withCredentials:true}).then(function(response){if(response.data.logged_in){_this.handleLogin(response);}else{_this.handleLogout();}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.handleLogin=function(data){_this.setState({userRes:data.data.user});};_this.handleLogout=function(){_this.setState({userRes:{}});};_this.redirect=function(){_this.props.history.push(\"/therapist-certificate\");};_this.state={file:\"\",imagePreviewUrl:\"\",userRes:{}};return _this;}_createClass(ProfileImage,[{key:\"componentDidMount\",value:function componentDidMount(){this.loginStatus();}},{key:\"_handleSubmit\",value:function _handleSubmit(e){var _this2=this;e.preventDefault();var userRes=this.state.userRes;var imageData=new FormData();imageData.append('user[avatar]',this.state.file);axios.put(\"\".concat(API_ENDPOINT,\"/users/\").concat(userRes.id),imageData,{'Content-Type':'multipart/form-data',withCredentials:true}).then(function(response){if(response.status===200||response.status===204){_this2.props.showToast(1,'Profile picture updated.');_this2.redirect();}}).catch(function(response){_this2.props.showToast(2,'Unbale to update Profile picture.');console.log(response);});}},{key:\"_handleImageChange\",value:function _handleImageChange(e){var _this3=this;e.preventDefault();var reader=new FileReader();var file=e.target.files[0];reader.onloadend=function(){_this3.setState({file:file,imagePreviewUrl:reader.result});};reader.readAsDataURL(file);}},{key:\"render\",value:function render(){var _this4=this;var imagePreviewUrl=this.state.imagePreviewUrl;var $imagePreview=null;if(imagePreviewUrl){$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:imagePreviewUrl,alt:\"\"});}else{$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:placeholder,alt:\"upload profile\"});}return/*#__PURE__*/React.createElement(\"div\",{className:\"register_form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"signup-form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"previewComponent\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return _this4._handleSubmit(e);}},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center text-dark\"},\"Upload Profile Image\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"image_container mx-auto mb-4\"},$imagePreview),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",className:\"form-control\",onChange:function onChange(e){return _this4._handleImageChange(e);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",type:\"submit\",onClick:function onClick(e){return _this4._handleSubmit(e);}},\"Upload Image\"))))));}}]);return ProfileImage;}(Component);export default ProfileImage;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/ProfileImage.js"],"names":["React","Component","axios","API_ENDPOINT","placeholder","ProfileImage","props","loginStatus","get","withCredentials","then","response","data","logged_in","handleLogin","handleLogout","catch","error","console","log","setState","userRes","user","redirect","history","push","state","file","imagePreviewUrl","e","preventDefault","imageData","FormData","append","put","id","status","showToast","reader","FileReader","target","files","onloadend","result","readAsDataURL","$imagePreview","_handleSubmit","_handleImageChange"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { API_ENDPOINT } from \"../../constant\";\r\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\r\n\r\nclass ProfileImage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      file: \"\",\r\n      imagePreviewUrl: \"\",\r\n      userRes: {}\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loginStatus();\r\n  }\r\n\r\n  loginStatus = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/logged_in`, { withCredentials: true })\r\n      .then(response => {\r\n        if (response.data.logged_in) {\r\n          this.handleLogin(response);\r\n        } else {\r\n          this.handleLogout();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  handleLogin = data => {\r\n    this.setState({\r\n      userRes: data.data.user\r\n    });\r\n\r\n  };\r\n\r\n  handleLogout = () => {\r\n    this.setState({\r\n      userRes: {}\r\n    });\r\n  };\r\n\r\n  _handleSubmit(e) {\r\n    e.preventDefault();\r\n    const { userRes } = this.state;\r\n    var imageData = new FormData();\r\n    imageData.append('user[avatar]', this.state.file);\r\n    axios\r\n      .put(`${API_ENDPOINT}/users/${userRes.id}`, imageData, { 'Content-Type': 'multipart/form-data', withCredentials: true })\r\n      .then(response => {\r\n        if (response.status === 200 || response.status === 204) {\r\n          this.props.showToast(1, 'Profile picture updated.')\r\n          this.redirect();\r\n        }\r\n      })\r\n      .catch(response => {\r\n        this.props.showToast(2, 'Unbale to update Profile picture.')\r\n        console.log(response);\r\n      });\r\n  }\r\n\r\n  _handleImageChange(e) {\r\n    e.preventDefault();\r\n\r\n    let reader = new FileReader();\r\n    let file = e.target.files[0];\r\n\r\n    reader.onloadend = () => {\r\n      this.setState({\r\n        file: file,\r\n        imagePreviewUrl: reader.result\r\n      });\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  redirect = () => {\r\n    this.props.history.push(\"/therapist-certificate\");\r\n  };\r\n\r\n  render() {\r\n    let { imagePreviewUrl } = this.state;\r\n    let $imagePreview = null;\r\n    if (imagePreviewUrl) {\r\n      $imagePreview = <img src={imagePreviewUrl} alt=\"\" />;\r\n    } else {\r\n      $imagePreview = <img src={placeholder} alt=\"upload profile\" />;\r\n    }\r\n    return (\r\n      <div className=\"register_form\">\r\n        <div className=\"signup-form\">\r\n          <div className=\"previewComponent\">\r\n            <form onSubmit={e => this._handleSubmit(e)}>\r\n              <h4 className=\"text-center text-dark\">Upload Profile Image</h4>\r\n              <hr />\r\n              <div className=\"image_container mx-auto mb-4\">\r\n                {$imagePreview}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"file\"\r\n                  className=\"form-control\"\r\n                  onChange={e => this._handleImageChange(e)}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <button\r\n                  className=\"btn btn-primary\"\r\n                  type=\"submit\"\r\n                  onClick={e => this._handleSubmit(e)}\r\n                >\r\n                  Upload Image\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default ProfileImage;\r\n"]},"metadata":{},"sourceType":"module"}