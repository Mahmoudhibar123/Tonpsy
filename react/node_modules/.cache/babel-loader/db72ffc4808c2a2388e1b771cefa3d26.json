{"ast":null,"code":"import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{API_ENDPOINT}from\"../../constant\";import placeholder from\"./../../assets/img/profile-placeholder.png\";var TherapistCertificate=/*#__PURE__*/function(_Component){_inherits(TherapistCertificate,_Component);var _super=_createSuper(TherapistCertificate);function TherapistCertificate(props){var _this;_classCallCheck(this,TherapistCertificate);_this=_super.call(this,props);_this.loginStatus=function(){axios.get(\"\".concat(API_ENDPOINT,\"/logged_in\"),{withCredentials:true}).then(function(response){if(response.data.logged_in){_this.handleLogin(response);}else{_this.handleLogout();}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.handleLogin=function(data){_this.setState({userRes:data.data.user});};_this.redirect=function(){_this.props.showToast(1,'Wait for Admin Approval.');_this.handleLogout();};_this.handleLogout=function(){axios.delete(\"\".concat(API_ENDPOINT,\"/logout\"),{withCredentials:true}).then(function(response){_this.props.handleLogout();_this.props.history.push(\"/\");}).catch(function(error){return console.log(error);});};_this.state={file:\"\",imagePreviewUrl:\"\",userRes:{}};return _this;}_createClass(TherapistCertificate,[{key:\"componentDidMount\",value:function componentDidMount(){this.loginStatus();}},{key:\"_handleSubmit\",value:function _handleSubmit(e){var _this2=this;e.preventDefault();var userRes=this.state.userRes;var imageData=new FormData();imageData.append('doctor[certificate]',this.state.file);axios.put(\"\".concat(API_ENDPOINT,\"/doctors/\").concat(userRes.doctor.id,\"/upload_certificate\"),imageData,{'Content-Type':'multipart/form-data',withCredentials:true}).then(function(response){if(response.status===200||response.status===204){_this2.props.showToast(1,'Certificate updated.');_this2.redirect();}}).catch(function(response){_this2.props.showToast(2,'Unbale to update Certificate.');console.log(response);});}},{key:\"_handleImageChange\",value:function _handleImageChange(e){var _this3=this;e.preventDefault();var reader=new FileReader();var file=e.target.files[0];reader.onloadend=function(){_this3.setState({file:file,imagePreviewUrl:reader.result});};reader.readAsDataURL(file);}},{key:\"render\",value:function render(){var _this4=this;var imagePreviewUrl=this.state.imagePreviewUrl;var $imagePreview=null;if(imagePreviewUrl){$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:imagePreviewUrl,alt:\"\"});}else{$imagePreview=/*#__PURE__*/React.createElement(\"img\",{src:placeholder,alt:\"certificate\"});}return/*#__PURE__*/React.createElement(\"div\",{className:\"register_form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"signup-form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"previewComponent\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return _this4._handleSubmit(e);}},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-center text-dark\"},\"Upload Certificate\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"image_container mx-auto mb-4\"},$imagePreview),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",className:\"form-control\",onChange:function onChange(e){return _this4._handleImageChange(e);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",type:\"submit\",onClick:function onClick(e){return _this4._handleSubmit(e);}},\"Upload Certificate\"))))));}}]);return TherapistCertificate;}(Component);export default TherapistCertificate;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/user/TherapistCertificate.js"],"names":["React","Component","axios","API_ENDPOINT","placeholder","TherapistCertificate","props","loginStatus","get","withCredentials","then","response","data","logged_in","handleLogin","handleLogout","catch","error","console","log","setState","userRes","user","redirect","showToast","delete","history","push","state","file","imagePreviewUrl","e","preventDefault","imageData","FormData","append","put","doctor","id","status","reader","FileReader","target","files","onloadend","result","readAsDataURL","$imagePreview","_handleSubmit","_handleImageChange"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { API_ENDPOINT } from \"../../constant\";\r\nimport placeholder from \"./../../assets/img/profile-placeholder.png\";\r\n\r\nclass TherapistCertificate extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      file: \"\",\r\n      imagePreviewUrl: \"\",\r\n      userRes: {}\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loginStatus();\r\n  }\r\n\r\n  loginStatus = () => {\r\n    axios\r\n      .get(`${API_ENDPOINT}/logged_in`, { withCredentials: true })\r\n      .then(response => {\r\n        if (response.data.logged_in) {\r\n          this.handleLogin(response);\r\n        } else {\r\n          this.handleLogout();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  handleLogin = data => {\r\n    this.setState({\r\n      userRes: data.data.user\r\n    });\r\n\r\n  };\r\n\r\n  _handleSubmit(e) {\r\n    e.preventDefault();\r\n    const { userRes } = this.state;\r\n    var imageData = new FormData();\r\n    imageData.append('doctor[certificate]', this.state.file);\r\n    axios\r\n      .put(`${API_ENDPOINT}/doctors/${userRes.doctor.id}/upload_certificate`, imageData, { 'Content-Type': 'multipart/form-data', withCredentials: true })\r\n      .then(response => {\r\n        if (response.status === 200 || response.status === 204) {\r\n          this.props.showToast(1, 'Certificate updated.')\r\n          this.redirect();\r\n        }\r\n      })\r\n      .catch(response => {\r\n        this.props.showToast(2, 'Unbale to update Certificate.')\r\n        console.log(response);\r\n      });\r\n  }\r\n\r\n  _handleImageChange(e) {\r\n    e.preventDefault();\r\n\r\n    let reader = new FileReader();\r\n    let file = e.target.files[0];\r\n\r\n    reader.onloadend = () => {\r\n      this.setState({\r\n        file: file,\r\n        imagePreviewUrl: reader.result\r\n      });\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  redirect = () => {\r\n    this.props.showToast(1, 'Wait for Admin Approval.')\r\n    this.handleLogout();\r\n  };\r\n\r\n  handleLogout = () => {\r\n    axios\r\n      .delete(`${API_ENDPOINT}/logout`, { withCredentials: true })\r\n      .then((response) => {\r\n        this.props.handleLogout();\r\n        this.props.history.push(\"/\");\r\n      })\r\n      .catch((error) => console.log(error));\r\n  };\r\n\r\n  render() {\r\n    let { imagePreviewUrl } = this.state;\r\n    let $imagePreview = null;\r\n    if (imagePreviewUrl) {\r\n      $imagePreview = <img src={imagePreviewUrl} alt=\"\" />;\r\n    } else {\r\n      $imagePreview = <img src={placeholder} alt=\"certificate\" />;\r\n    }\r\n    return (\r\n      <div className=\"register_form\">\r\n        <div className=\"signup-form\">\r\n          <div className=\"previewComponent\">\r\n            <form onSubmit={e => this._handleSubmit(e)}>\r\n              <h4 className=\"text-center text-dark\">Upload Certificate</h4>\r\n              <hr />\r\n              <div className=\"image_container mx-auto mb-4\">\r\n                {$imagePreview}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"file\"\r\n                  className=\"form-control\"\r\n                  onChange={e => this._handleImageChange(e)}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <button\r\n                  className=\"btn btn-primary\"\r\n                  type=\"submit\"\r\n                  onClick={e => this._handleSubmit(e)}\r\n                >\r\n                  Upload Certificate\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default TherapistCertificate;\r\n"]},"metadata":{},"sourceType":"module"}