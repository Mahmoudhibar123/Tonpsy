{"ast":null,"code":"import _defineProperty from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/fizoumizou/Documents/pfe/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{Link}from\"react-router-dom\";import{API_ENDPOINT}from\"../../constant\";import\"./Register.css\";import therapistbg from\"../../assets/img/therapist.jpg\";import patientbg from\"../../assets/img/patient.jpg\";var Register=/*#__PURE__*/function(_Component){_inherits(Register,_Component);var _super=_createSuper(Register);function Register(props){var _this;_classCallCheck(this,Register);_this=_super.call(this,props);_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();var _this$state=_this.state,username=_this$state.username,email=_this$state.email,password=_this$state.password,password_confirmation=_this$state.password_confirmation,role=_this$state.role;var user={username:username,email:email,password:password,password_confirmation:password_confirmation,role:role.toLowerCase()===\"therapist\"?1:0};axios.post(\"\".concat(API_ENDPOINT,\"/users\"),{user:user},{withCredentials:true}).then(function(response){if(response.data.status===\"created\"){response.data.user[\"doctor\"]={};response.data.user[\"doctor\"][\"id\"]=response.data.user.doctor_id;response.data.user[\"doctor\"][\"name\"]=response.data.user.first_name;_this.props.handleLogin(response.data);_this.props.showToast(1,\"Registration successfull.\");_this.redirect(response.data.user);}else{_this.props.showToast(2,response.data.errors?response.data.errors[0]:\"Unbale to create Registration.\");_this.setState({errors:response.data.errors});}}).catch(function(error){return console.log(\"api errors:\",error);});};_this.redirect=function(user){if(user.role.toLowerCase()===\"therapist\"){_this.props.history.push(\"/about\",{doctor_id:user.doctor_id});}else{_this.props.history.push(\"/doctors/psychiatrist\");}};_this.handleErrors=function(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"ul\",null,_this.state.errors.map(function(error){return/*#__PURE__*/React.createElement(\"li\",{key:error},error);})));};_this.state={username:\"\",email:\"\",password:\"\",password_confirmation:\"\",errors:\"\"};return _this;}_createClass(Register,[{key:\"componentDidMount\",value:function componentDidMount(){var role=this.props.match.params.role;this.setState({role:role});}},{key:\"render\",value:function render(){var _this$state2=this.state,username=_this$state2.username,email=_this$state2.email,password=_this$state2.password,password_confirmation=_this$state2.password_confirmation,role=_this$state2.role;return/*#__PURE__*/React.createElement(\"div\",{className:\"login_form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid bg-white h-100 overflow-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row h-100 justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-7 d-none d-lg-block\",style:{backgroundImage:\"url(\"+(role&&role.toLowerCase()===\"therapist\"?therapistbg:patientbg)+\")\",backgroundPosition:\"center\",backgroundSize:\"cover\",backgroundRepeat:\"no-repeat\"}}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-5 col-md-8 p-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"register_form1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"signup-form\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"h2\",null,\"Register\"),/*#__PURE__*/React.createElement(\"p\",null,\"Create your account\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",name:\"username\",placeholder:\"Username\",required:\"required\",value:username,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"email\",className:\"form-control\",name:\"email\",placeholder:\"Email Address\",required:\"required\",value:email,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",placeholder:\"Password\",required:\"required\",value:password,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",name:\"password_confirmation\",placeholder:\"Confirm Password\",required:\"required\",value:password_confirmation,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\"},\"Create account\"),/*#__PURE__*/React.createElement(\"div\",{className:\"text-center mt-2\"},\"Already have an account?\",\" \",/*#__PURE__*/React.createElement(Link,{to:\"/auth/login/\".concat(role)},\"Login here\"))))))))));}}]);return Register;}(Component);export default Register;","map":{"version":3,"sources":["/home/fizoumizou/Documents/pfe/react/src/components/auth/Register.js"],"names":["React","Component","axios","Link","API_ENDPOINT","therapistbg","patientbg","Register","props","handleChange","event","target","name","value","setState","handleSubmit","preventDefault","state","username","email","password","password_confirmation","role","user","toLowerCase","post","withCredentials","then","response","data","status","doctor_id","first_name","handleLogin","showToast","redirect","errors","catch","error","console","log","history","push","handleErrors","map","match","params","backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { API_ENDPOINT } from \"../../constant\";\r\nimport \"./Register.css\";\r\nimport therapistbg from \"../../assets/img/therapist.jpg\";\r\nimport patientbg from \"../../assets/img/patient.jpg\";\r\n\r\nclass Register extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      password_confirmation: \"\",\r\n      errors: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { role } = this.props.match.params;\r\n    this.setState({ role: role });\r\n  }\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const {\r\n      username,\r\n      email,\r\n      password,\r\n      password_confirmation,\r\n      role,\r\n    } = this.state;\r\n    let user = {\r\n      username: username,\r\n      email: email,\r\n      password: password,\r\n      password_confirmation: password_confirmation,\r\n      role: role.toLowerCase() === \"therapist\" ? 1 : 0,\r\n    };\r\n    axios\r\n      .post(`${API_ENDPOINT}/users`, { user }, { withCredentials: true })\r\n      .then((response) => {\r\n        if (response.data.status === \"created\") {\r\n          response.data.user[\"doctor\"] = {};\r\n          response.data.user[\"doctor\"][\"id\"] = response.data.user.doctor_id;\r\n          response.data.user[\"doctor\"][\"name\"] = response.data.user.first_name;\r\n          this.props.handleLogin(response.data);\r\n          this.props.showToast(1, \"Registration successfull.\");\r\n          this.redirect(response.data.user);\r\n        } else {\r\n          this.props.showToast(\r\n            2,\r\n            response.data.errors\r\n              ? response.data.errors[0]\r\n              : \"Unbale to create Registration.\"\r\n          );\r\n          this.setState({\r\n            errors: response.data.errors,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => console.log(\"api errors:\", error));\r\n  };\r\n\r\n  redirect = (user) => {\r\n    if (user.role.toLowerCase() === \"therapist\") {\r\n      this.props.history.push(\"/about\", { doctor_id: user.doctor_id });\r\n    } else {\r\n      this.props.history.push(\"/doctors/psychiatrist\");\r\n    }\r\n  };\r\n\r\n  handleErrors = () => {\r\n    return (\r\n      <div>\r\n        <ul>\r\n          {this.state.errors.map((error) => {\r\n            return <li key={error}>{error}</li>;\r\n          })}\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { username, email, password, password_confirmation, role } = this.state;\r\n\r\n    return (\r\n      <div className=\"login_form\">\r\n        <div className=\"container-fluid bg-white h-100 overflow-auto\">\r\n          <div className=\"row h-100 justify-content-center\">\r\n            <div\r\n              className=\"col-lg-7 d-none d-lg-block\"\r\n              style={{\r\n                backgroundImage: \"url(\" + (role && role.toLowerCase() === \"therapist\" ? therapistbg : patientbg) + \")\",\r\n                backgroundPosition: \"center\",\r\n                backgroundSize: \"cover\",\r\n                backgroundRepeat: \"no-repeat\",\r\n              }}\r\n            ></div>\r\n            <div className=\"col-lg-5 col-md-8 p-5\">\r\n              <div className=\"register_form1\">\r\n                <div className=\"signup-form\">\r\n                  <form onSubmit={this.handleSubmit}>\r\n                    <h2>Register</h2>\r\n                    <p>Create your account</p>\r\n                    <hr />\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"text\"\r\n                        className=\"form-control\"\r\n                        name=\"username\"\r\n                        placeholder=\"Username\"\r\n                        required=\"required\"\r\n                        value={username}\r\n                        onChange={this.handleChange}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"email\"\r\n                        className=\"form-control\"\r\n                        name=\"email\"\r\n                        placeholder=\"Email Address\"\r\n                        required=\"required\"\r\n                        value={email}\r\n                        onChange={this.handleChange}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"password\"\r\n                        className=\"form-control\"\r\n                        name=\"password\"\r\n                        placeholder=\"Password\"\r\n                        required=\"required\"\r\n                        value={password}\r\n                        onChange={this.handleChange}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <input\r\n                        type=\"password\"\r\n                        className=\"form-control\"\r\n                        name=\"password_confirmation\"\r\n                        placeholder=\"Confirm Password\"\r\n                        required=\"required\"\r\n                        value={password_confirmation}\r\n                        onChange={this.handleChange}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                      <button type=\"submit\" className=\"btn btn-primary btn-block\">\r\n                        Create account\r\n                      </button>\r\n                      <div className=\"text-center mt-2\">\r\n                        Already have an account?{\" \"}\r\n                        <Link to={`/auth/login/${role}`}>Login here</Link>\r\n                      </div>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}